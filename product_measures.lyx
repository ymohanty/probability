#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass amsbook
\use_default_options true
\begin_modules
theorems-ams
eqs-within-sections
figs-within-sections
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Chapter
Measures on product spaces
\begin_inset CommandInset label
LatexCommand label
name "chap:productMeasures"

\end_inset


\end_layout

\begin_layout Standard
In calculus, we learnt that the theory of integration readily extends from
 from real valued functions on 
\begin_inset Formula $\R$
\end_inset

 to real valued functions on the Euclidean space 
\begin_inset Formula $\R^{n}.$
\end_inset

 The extension is usually motivated geometrically by studying the volume
 under the surface of a sufficiently smooth function 
\begin_inset Formula $f:\R^{2}\to\R$
\end_inset

.
 The idea is that if a function is sufficiently well behaved, then one can
 recover the volume under the surface by looking at the areas under various
 ``slices
\begin_inset Quotes erd
\end_inset

 of the function and then summing up those areas.
 Importantly, under the requisite smoothness conditions, the ``slices
\begin_inset Quotes erd
\end_inset

 could have been made horizontally or vertically, and we would get the same
 result.
 This intuition leads to the Fubini theorem for multiple integration in
 the Riemann setting:
\begin_inset Formula 
\[
\int_{a}^{b}\int_{c}^{d}f(x,y)dydx=\int_{c}^{d}\int_{a}^{b}f(x,y)dxdy.
\]

\end_inset

In our linear functional notation, this can be written as
\begin_inset Formula 
\[
\lambda^{x}\left(\lambda^{y}\left(f\left(x,y\right)\indicate_{\left[c,d\right]}\right)\indicate_{\left[a,b\right]}\right)=\lambda^{y}\left(\lambda^{x}\left(f\left(x,y\right)\indicate_{\left[a,b\right]}\right)\indicate_{\left[c,d\right]}\right).
\]

\end_inset

Here 
\begin_inset Formula $\lambda$
\end_inset

 is the Lebesgue measure as usual, and the superscripts denote the variable
 of integration.
 Note that we have dropped the bars on top of the 
\begin_inset Formula $\lambda$
\end_inset

 to denote integration to clean up notation; for comfort, you can just think
 of integration as an extension of a measure from the space of measurable
 indicators to the space of non-negative measurable or integrable functions,
 in the spirit of Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:integralMeasureEquivalence"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
The main goal of this chapter is to recover this result for the general
 measures.
 While important in its own right for the study of analysis on Euclidean
 spaces, in the context of probability theory, this result takes a far more
 important role.
 In particular, the ability to write a multiple integral as an iterated
 integral corresponds directly with the ability to factor the joint distribution
 of random variables into their marginal distributions; that is, it underpins
 the theory of 
\emph on
independent 
\emph default
random variables.
 Independence, and the departures from independence, constitute the central
 concepts of probabiliy theory.
\end_layout

\begin_layout Section
Product measures on finite product spaces
\end_layout

\begin_layout Subsection
Iterated integrals
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\left(\X,\F,\mu\right)$
\end_inset

 and 
\begin_inset Formula $\left(\mathcal{Y},\mathcal{G},\nu\right)$
\end_inset

 be measure spaces.
 Our interest is in defining measurable functions on the product space 
\begin_inset Formula $\X\times\mathcal{Y}.$
\end_inset

 The principle hurdle that is immediately apparent here is that the product
 of the 
\begin_inset Formula $\sigma-$
\end_inset

algebras 
\begin_inset Formula $\F\times\mathcal{G}:=\left\{ F\times G\mid F\in\F,G\in\mathcal{G}\right\} $
\end_inset

 is not necessarily a 
\begin_inset Formula $\sigma-$
\end_inset

algebra.
 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hl{ADD CE}
\end_layout

\end_inset

.
 It is easy to see, however, that it is a 
\begin_inset Formula $\pi-$
\end_inset

system (this fact will turn out to be important!).
 Any 
\begin_inset Formula $\sigma-$
\end_inset

algebra we use should certainly 
\emph on
contain 
\emph default

\begin_inset Formula $\mathcal{F}\times\mathcal{G}$
\end_inset

 and so the canonical choice is given by 
\begin_inset Formula $\mathcal{F}\otimes\mathcal{G:=\sigma\left(F\times G\right)}$
\end_inset

.
 A series of natural questions follow if we want iterated integrals to make
 sense.
 In particular, for a measurable map 
\begin_inset Formula $f\in\mathcal{M}^{+}\left(\X\times\mathcal{Y},\mathcal{F}\otimes\mathcal{G}\right),$
\end_inset

we want to know if the projections 
\begin_inset Formula $x\to f(x,y)$
\end_inset

 and 
\begin_inset Formula $y\to\mu^{x}\left(f\left(x,y\right)\right)$
\end_inset

 are 
\begin_inset Formula $\mathcal{F}$
\end_inset

 and 
\begin_inset Formula $\mathcal{G}$
\end_inset

 measurable, respectively.
 Thankfully, this turns out to be the case.
 We will use a long lost result from Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "chap:measurableFunctions"
plural "false"
caps "false"
noprefix "false"

\end_inset

: the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hyperref[thm:piLambdaThmFunctions]{$
\backslash
pi-
\backslash
lambda$ theorem for functions}
\end_layout

\end_inset

.
 Go over the hypotheses of this theorem before reading the following results.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:partialFunctionMeasurability"

\end_inset

For every 
\begin_inset Formula $f\in\mathcal{M}\left(\X\times\mathcal{Y},\mathcal{F}\otimes\mathcal{G}\right)$
\end_inset

, the maps 
\begin_inset Formula $x\to f(x,y)$
\end_inset

 and 
\begin_inset Formula $y\to f(x,y)$
\end_inset

 are 
\begin_inset Formula $\mathcal{F}/\borel\left(\R\right)$
\end_inset

 and 
\begin_inset Formula $\mathcal{G}/\borel\left(\R\right)$
\end_inset

 measurable for every 
\begin_inset Formula $y\in\mathcal{Y}$
\end_inset

 and 
\begin_inset Formula $x\in\X$
\end_inset

, respectively.
\end_layout

\begin_layout Proof
First we note, due to the fact that 
\begin_inset Formula $\left(A_{1}\times B_{1}\right)\cap\left(A_{2}\times B_{2}\right)=\left(A_{1}\cap A_{2}\right)\times\left(B_{1}\times B_{2}\right),$
\end_inset

that 
\begin_inset Formula $\mathcal{\mathcal{E:=}F}\times\mathcal{G}$
\end_inset

 is a 
\begin_inset Formula $\pi-$
\end_inset

system.
 Next, we claim that the space
\begin_inset Formula 
\[
\mathcal{H:=}\left\{ f\in\mathcal{M_{\text{bdd}}}\left(\X\times\mathcal{Y},\mathcal{F}\otimes\mathcal{G}\right)\mid\forall y\in\mathcal{Y}:x\to f\left(x,y\right)\text{is }\mathcal{G}/\borel\left(\R\right)\text{ measurable }\right\} 
\]

\end_inset

is a 
\begin_inset Formula $\lambda-$
\end_inset

space of functions.
 Note that 
\begin_inset Formula $\indicate_{\X\times\mathcal{Y}}$
\end_inset

is constant and bounded (and evidently partially measurable in our sense).
 Further, our space 
\begin_inset Formula $\mathcal{H}$
\end_inset

 is a vector space, since linear combinations of bounded measurable functions
 is bounded, and the partial measurability condition is also preserved under
 linear combinations (both results of Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:binaryOperationsMeasurableFunctions"
plural "false"
caps "false"
noprefix "false"

\end_inset

).
 Finally, 
\begin_inset Formula $\mathcal{H}$
\end_inset

 is closed under monotone limits (if they exist) since measurability (resp.
 partial measurability) is preserved under limits.
\end_layout

\begin_layout Proof
Now, observe that 
\begin_inset Formula $\left\{ \indicate_{A}\mid A\in\mathcal{E}\right\} \subseteq\mathcal{H}$
\end_inset

, since 
\begin_inset Formula $\indicate_{F\times G}=\indicate_{F}\indicate_{G}$
\end_inset

which is clearly bounded, measurable, and partially measurable in our sense.
 Thus applying the 
\begin_inset Formula $\pi-\lambda$
\end_inset

 theorem as discussed, we have that
\end_layout

\begin_layout Proof
\begin_inset Formula 
\[
\mathcal{M_{\text{bdd}}}\left(\X\times\mathcal{Y},\mathcal{F}\otimes\mathcal{G}\right)\subseteq\mathcal{H}
\]

\end_inset

which completes the proof for bounded functions.
\end_layout

\begin_layout Proof
Now we can simply take a function 
\begin_inset Formula $f\in\mathcal{M}\left(\X\times\mathcal{Y},\mathcal{F}\otimes\mathcal{G}\right)$
\end_inset

 and construct the bounded monotone sequences 
\begin_inset Formula $f_{n}^{\pm}:=\min\left\{ f^{\pm},n\right\} \in\mathcal{H}$
\end_inset

 by our results.
 We complete the proof by taking limits and noting that partial measurability
 is preserved.
 The same argument, of course, holds for 
\begin_inset Formula $y\to f\left(x,y\right)$
\end_inset

.
\end_layout

\begin_layout Standard
Note that the converse of this result is not necessarily true; that is,
 for a function 
\begin_inset Formula $f:\X\times\mathcal{Y}\to\R$
\end_inset

 with measurable sections 
\begin_inset Formula $x\to f\left(x,y\right)$
\end_inset

 and 
\begin_inset Formula $y\to f\left(x,y\right)$
\end_inset

, it need not be the case that 
\begin_inset Formula $f$
\end_inset

 is product measurable.
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:sectionMeasurableNotProductMeasurable"

\end_inset

Let 
\begin_inset Formula $V$
\end_inset

 be a Vitali set in 
\begin_inset Formula $\R$
\end_inset

 and let 
\begin_inset Formula $E=\left\{ \left(x,x\right)\mid x\in V\right\} .$
\end_inset

 Then let 
\begin_inset Formula $f\left(x,y\right)=\indicate_{E}\left(x,y\right)$
\end_inset

 and notice that
\begin_inset Formula 
\[
x\to f\left(x,y\right)=\begin{cases}
0, & y\notin V\\
\indicate\left\{ x=y\right\}  & y\in V.
\end{cases}
\]

\end_inset

In the first case, the section 
\begin_inset Formula $x\to f\left(x,y\right)$
\end_inset

 is constantly zero and hence measurable.
 In the second case, its an indicator function for the singleton 
\begin_inset Formula $\left\{ y\right\} $
\end_inset

 which is measurable since singletons are in 
\begin_inset Formula $\borel\left(\R\right).$
\end_inset

Therefore, for every 
\begin_inset Formula $y\in\R$
\end_inset

 the section 
\begin_inset Formula $x\to f\left(x,y\right)$
\end_inset

 is 
\begin_inset Formula $\borel\left(\R\right)/\borel\left(\R\right)$
\end_inset

 measurable.
 A similar argument shows that for every 
\begin_inset Formula $x\in\R$
\end_inset

, 
\begin_inset Formula $y\to f\left(x,y\right)$
\end_inset

 is Borel measurable.
 But notice that 
\begin_inset Formula $f$
\end_inset

 is measurable if and only if 
\begin_inset Formula $E$
\end_inset

 is measurable, but the map 
\begin_inset Formula $g\left(x\right)=\left(x,x\right)$
\end_inset

is measurable and 
\begin_inset Formula $g^{-1}\left[E\right]=V$
\end_inset

 is not measurable and so 
\begin_inset Formula $E$
\end_inset

 is not measurable.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:partialIntegralMeasurability"

\end_inset

Let 
\begin_inset Formula $\left(\X,\F,\mu\right)$
\end_inset

 and 
\begin_inset Formula $\left(\mathcal{Y},\mathcal{G},\nu\right)$
\end_inset

 be 
\begin_inset Formula $\sigma-$
\end_inset

finite measure spaces.
 For every function 
\begin_inset Formula $f\in\mathcal{M}^{+}\left(\X\times\mathcal{Y},\mathcal{F}\otimes\mathcal{G}\right)$
\end_inset

, the maps 
\begin_inset Formula $x\to\nu^{y}\left(f\left(x,y\right)\right)$
\end_inset

 and 
\begin_inset Formula $y\to\mu^{x}\left(f\left(x,y\right)\right)$
\end_inset

 are 
\begin_inset Formula $\mathcal{F}/\borel\left(\R\right)$
\end_inset

 and 
\begin_inset Formula $\mathcal{G}/\borel\left(\R\right)$
\end_inset

 measurable respectively.
\end_layout

\begin_layout Proof
We will prove that 
\begin_inset Formula $x\to\nu^{y}f\left(x,y\right)$
\end_inset

 is measurable; the other case follows by symmetry.
 First, let 
\begin_inset Formula $F_{i}\in\mathcal{\F}$
\end_inset

 be an increasing sequence of sets with finite measure such that 
\begin_inset Formula $\bigcup_{i\in\N}F_{i}=\mathcal{\X}.$
\end_inset

 Observe that for the indicator of any rectangle in 
\begin_inset Formula $F\times G\in\mathcal{E},$
\end_inset

we have that 
\begin_inset Formula $\nu^{y}\left(F\times G\right)=\indicate_{F}\nu\left(G\right)$
\end_inset

 which is measurable.
 Next, define
\begin_inset Formula 
\[
\mathcal{D}_{i}:=\left\{ D\in\mathcal{F}\otimes\mathcal{G}\mid x\to\nu^{y}\left(\indicate_{D}\indicate_{F_{i}}\right)\text{ is }\mathcal{\F}/\borel\left(\R\right)\ \text{measurable}\right\} 
\]

\end_inset

using Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:partialFunctionMeasurability"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to ensure that the expression is well defined.
 Notice that 
\begin_inset Formula $\mathcal{E}\subseteq\mathcal{D}$
\end_inset

 (and so in particular, 
\begin_inset Formula $\X\times\mathcal{Y}\in\mathcal{D}$
\end_inset

).
 Now suppose 
\begin_inset Formula $D_{1},D_{2}\in\mathcal{D}$
\end_inset

 such that 
\begin_inset Formula $D_{1}\subseteq D_{2}$
\end_inset

.
 Then, letting 
\begin_inset Formula $\nu_{i}$
\end_inset

 denoting the measure that has density 
\begin_inset Formula $\indicate_{F_{i}}$
\end_inset

 with respect to 
\begin_inset Formula $\nu$
\end_inset


\begin_inset Formula 
\[
\nu_{i}^{y}\left(\indicate_{D_{2}\setminus D_{1}}\right)=\nu_{i}^{y}\left(\indicate_{D_{2}}\right)-\nu_{i}^{y}\left(\indicate_{D_{1}}\right)
\]

\end_inset

 which is measurable by Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:binaryOperationsMeasurableFunctions"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Note that the expression on the right is well defined since 
\begin_inset Formula $\nu_{i}$
\end_inset

 is a finite measure and indicator functions are bounded (and so no 
\begin_inset Formula $\infty-\infty$
\end_inset

 situations arise).
 Similarly, suppose we have an increasing sequence of sets 
\begin_inset Formula $D_{n}\in\mathcal{D}_{i}$
\end_inset

, with 
\begin_inset Formula $D:=\bigcup_{n\in\N}D_{n}$
\end_inset

, we have 
\begin_inset Formula 
\begin{align*}
\nu_{i}^{y}\left(\indicate_{D}\right) & =\nu_{i}^{y}\left(\sup_{n\in\N}\indicate_{D_{n}}\right)\\
 & =\nu_{i}^{y}\left(\lim_{n\to\infty}\indicate_{D_{n}}\right)\\
 & =\lim_{n\to\infty}\nu_{i}^{y}\left(\indicate_{D_{n}}\right)
\end{align*}

\end_inset

where we have used Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:indicatorFunctionsArbitraryOperations"
plural "false"
caps "false"
noprefix "false"

\end_inset

 in the first equality, the nested nature of 
\begin_inset Formula $D_{n}$
\end_inset

 in the second equality, and the monotone convergence theorem in the final
 equality.
 By Corollary 
\begin_inset CommandInset ref
LatexCommand ref
reference "cor:limSupLimInfMeasurable"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the limit is measurable and so 
\begin_inset Formula $D\in\mathcal{D}_{i}$
\end_inset

.
 Thus we have shown that each 
\begin_inset Formula $\mathcal{D}_{i}$
\end_inset

 is a 
\begin_inset Formula $\lambda-$
\end_inset

system containing 
\begin_inset Formula $\mathcal{E}$
\end_inset

, a 
\begin_inset Formula $\pi-$
\end_inset

system, and so by the 
\begin_inset Formula $\pi-\lambda$
\end_inset

 theorem, 
\begin_inset Formula $\F\otimes\mathcal{G}=\sigma\left(\mathcal{E}\right)\subseteq\mathcal{D}_{i}$
\end_inset

 for all 
\begin_inset Formula $i\in\N$
\end_inset

.
 Finally, for any 
\begin_inset Formula $D\in\F\otimes\mathcal{G}$
\end_inset

, we know that 
\begin_inset Formula $x\to\nu_{i}^{y}\left(\indicate_{D}\right)$
\end_inset

 is measurable, and by yet another application of monotone convergence and
 Corollary 
\begin_inset CommandInset ref
LatexCommand ref
reference "cor:limSupLimInfMeasurable"
plural "false"
caps "false"
noprefix "false"

\end_inset

, 
\begin_inset Formula $x\to\nu^{y}\left(\indicate_{D}\right)$
\end_inset

 is also measurable.
\end_layout

\begin_layout Proof
This completes the proof for indiactor functions.
 We can then show that measurability holds for non-negative measurable simple
 functions by using the linearity of integration and the fact that measurability
 is preserved under linear combinations.
 Finally, we show the result for general non-negative measurable functions
 by approximating them by simple functions from below, applying monotone
 convergence, and using Corollary 
\begin_inset CommandInset ref
LatexCommand ref
reference "cor:limSupLimInfMeasurable"
plural "false"
caps "false"
noprefix "false"

\end_inset

 yet again.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hl{Add remarks under each measurability lemma to extend to n dimensions
 via induction}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Separator plain
\end_inset


\end_layout

\begin_layout Standard
With the technicalities out of the way, we can show that iterated integrals
 give the same result under certain conditions.
 This is a generalization of the result we saw all the way back in Lemma
 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:TonelliForSeries"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Theorem
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Tonelli
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "thm:tonelli"

\end_inset

Let 
\begin_inset Formula $\left(\X,\F,\mu\right)$
\end_inset

 and 
\begin_inset Formula $\left(\mathcal{Y},\mathcal{G},\nu\right)$
\end_inset

 be measure spaces.
 Then, for any 
\begin_inset Formula $f\in\mathcal{M}^{+}\left(\X\times\mathcal{Y},\mathcal{F}\otimes\mathcal{G}\right)$
\end_inset

, the functions 
\begin_inset Formula 
\[
\gamma_{1}\left(f\right):=\nu^{y}\mu^{x}\left(f\right)
\]

\end_inset

and
\begin_inset Formula 
\[
\gamma_{2}\left(f\right):\mu^{x}\nu^{y}\left(f\right)
\]

\end_inset

are integrals on 
\begin_inset Formula $\mathcal{M}^{+}\left(\X\times\mathcal{Y},\mathcal{F}\otimes\mathcal{G}\right).$
\end_inset

 Moreover, if 
\begin_inset Formula $\mu$
\end_inset

and 
\begin_inset Formula $\nu$
\end_inset

 are 
\begin_inset Formula $\sigma-$
\end_inset

finite, 
\begin_inset Formula $\gamma_{1}\left(f\right)=\gamma_{2}\left(f\right)$
\end_inset

 for every 
\begin_inset Formula $f\in\mathcal{M}^{+}\left(\X\times\mathcal{Y},\mathcal{F}\otimes\mathcal{G}\right).$
\end_inset


\end_layout

\begin_layout Proof
We show that 
\begin_inset Formula $\gamma_{1}$
\end_inset

 is an integral; the argument for 
\begin_inset Formula $\gamma_{2}$
\end_inset

 is the analagous.
 First, observe that 
\begin_inset Formula $\gamma_{1}\left(0\right)=\nu^{y}\mu^{x}\left(0\right)=\nu^{y}\left(0\right)=0$
\end_inset

, given that 
\begin_inset Formula $\nu$
\end_inset

 and 
\begin_inset Formula $\mu$
\end_inset

 are integrals.
 Second, note that for 
\begin_inset Formula $\alpha,\beta\geq0$
\end_inset

, and 
\begin_inset Formula $f,g\in\mathcal{M}^{+}\left(\X\times\mathcal{Y},\mathcal{F}\otimes\mathcal{G}\right)$
\end_inset


\begin_inset Formula 
\begin{align*}
\gamma_{1}\left(\alpha f+\beta g\right) & =\nu^{y}\mu^{x}\left(\alpha f+\beta g\right)\\
 & =\nu^{y}\left(\alpha\mu^{x}f+\beta\mu^{x}g\right)\\
 & =\alpha\nu^{y}\mu^{x}\left(f\right)+\beta\nu^{y}\mu^{x}\left(g\right)\\
 & =\alpha\gamma_{1}\left(f\right)+\beta\gamma_{1}\left(g\right).
\end{align*}

\end_inset

Finally, observe that for 
\begin_inset Formula $f_{n}\in\mathcal{M}^{+}\left(\X\times\mathcal{Y},\mathcal{F}\otimes\mathcal{G}\right)$
\end_inset

 such that 
\begin_inset Formula $f_{n}\leq f_{n+1}$
\end_inset

 and 
\begin_inset Formula $f_{n}\to f$
\end_inset

, we have
\begin_inset Formula 
\begin{align*}
\lim_{n\to\infty}\gamma_{1}\left(f_{n}\right) & =\lim_{n\to\infty}\nu^{y}\mu^{x}\left(f_{n}\right)\\
 & =\nu^{y}\mu^{x}\left(\lim_{n\to\infty}f_{n}\right)\\
 & =\gamma_{1}\left(f\right)
\end{align*}

\end_inset

by applying monotone convergence twice.
\end_layout

\begin_layout Proof
Therefore, by Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:integralMeasureEquivalence"
plural "false"
caps "false"
noprefix "false"

\end_inset

, 
\begin_inset Formula $\gamma_{1}$
\end_inset

 and 
\begin_inset Formula $\gamma_{2}$
\end_inset

 are integrals on 
\begin_inset Formula $\mathcal{M}^{+}\left(\X\times\mathcal{Y},\mathcal{F}\otimes\mathcal{G}\right)$
\end_inset

 with respect to measures defined by integrating indicator functions in
 
\begin_inset Formula $\mathcal{F\otimes\mathcal{G}}.$
\end_inset

 If 
\begin_inset Formula $\mu$
\end_inset

 and 
\begin_inset Formula $\nu$
\end_inset

 are 
\begin_inset Formula $\sigma-$
\end_inset

finite, the two integrals can be shown to be equal by showing that the correspon
ding measures are equal on a generating 
\begin_inset Formula $\pi-$
\end_inset

system that can approximate the full space (courtesy of our 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hyperref[thm:uniquenessMeasures]{uniqueness theorem}
\end_layout

\end_inset

).
 Of course, since 
\begin_inset Formula $\mathcal{F\times\mathcal{G}}$
\end_inset

 is a 
\begin_inset Formula $\pi-$
\end_inset

system, for 
\begin_inset Formula $F\in\F,G\in\mathcal{G}$
\end_inset


\begin_inset Formula 
\begin{align*}
\gamma_{1}\left(\indicate_{F\times G}\right) & =\nu^{y}\mu^{x}\left(\indicate_{F\times G}\left(x,y\right)\right)\\
 & =\nu^{y}\mu^{x}\left(\indicate_{F}\left(x\right)\indicate_{G}\left(y\right)\right)\\
 & =\nu\left(G\right)\mu\left(F\right)\\
 & =\mu^{x}\nu^{y}\left(\indicate_{F}\left(x\right)\indicate_{G}\left(y\right)\right)\\
 & =\gamma_{2}\left(\indicate_{F\times G}\right)
\end{align*}

\end_inset

completing the proof.
 Since our measures 
\begin_inset Formula $\mu,\nu$
\end_inset

 are 
\begin_inset Formula $\sigma-$
\end_inset

finite, we know that there exist sets 
\begin_inset Formula $E_{i}\in\mathcal{F\times\mathcal{G}}$
\end_inset

 such that 
\begin_inset Formula $\bigcup E_{i}=\X\times\mathcal{Y}.$
\end_inset

 This completes the proof.
\end_layout

\begin_layout Standard
Note that the 
\begin_inset Formula $\sigma-$
\end_inset

finiteness condition is actually necessary for the uniqueness of the integrals,
 as Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:tonelliFailNonSigmaFinite"
plural "false"
caps "false"
noprefix "false"

\end_inset

 illustrates.
\end_layout

\begin_layout Corollary
\begin_inset Argument 1
status open

\begin_layout Plain Layout
Fubini's Theorem
\end_layout

\end_inset

Let 
\begin_inset Formula $\left(\X,\F,\mu\right)$
\end_inset

 and 
\begin_inset Formula $\left(\mathcal{Y},\mathcal{G},\nu\right)$
\end_inset

 be 
\begin_inset Formula $\sigma-$
\end_inset

finite measure spaces and let 
\begin_inset Formula $f\in\mathcal{M}\left(\X\times\mathcal{Y},\F\otimes\mathcal{G}\right).$
\end_inset

 If one of 
\begin_inset Formula $\gamma_{1}\left(\lvert f\rvert\right):=\nu^{y}\mu^{x}\left(\lvert f\rvert\right)$
\end_inset

 or 
\begin_inset Formula $\gamma_{2}\left(\lvert f\rvert\right):\mu^{x}\nu^{y}\left(\lvert f\rvert\right)$
\end_inset

 is finite, then
\end_layout

\begin_layout Corollary
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{enumerate}[label=(
\backslash
roman*),leftmargin=.1
\backslash
linewidth,rightmargin=.4
\backslash
linewidth]
\end_layout

\begin_layout Plain Layout


\backslash
item $x 
\backslash
to f
\backslash
left(x,y
\backslash
right) 
\backslash
in 
\backslash
Lp{1}{
\backslash
mu}$
\end_layout

\begin_layout Plain Layout


\backslash
item $y 
\backslash
to f
\backslash
left(x,y
\backslash
right) 
\backslash
in 
\backslash
Lp{1}{
\backslash
nu}$
\end_layout

\begin_layout Plain Layout


\backslash
item $x 
\backslash
to 
\backslash
nu^y
\backslash
left(f
\backslash
left(x,y
\backslash
right)
\backslash
right)
\backslash
in 
\backslash
Lp{1}{
\backslash
mu}$
\end_layout

\begin_layout Plain Layout


\backslash
item $y 
\backslash
to 
\backslash
mu^x
\backslash
left(f
\backslash
left(x,y
\backslash
right)
\backslash
right) 
\backslash
in 
\backslash
Lp{1}{
\backslash
nu}$
\end_layout

\begin_layout Plain Layout


\backslash
item $
\backslash
gamma_1
\backslash
left(f
\backslash
right) = 
\backslash
gamma_2
\backslash
left(f
\backslash
right)$
\end_layout

\begin_layout Plain Layout


\backslash
end{enumerate}
\end_layout

\end_inset


\end_layout

\begin_layout Proof
Note that since 
\begin_inset Formula $\lvert f\rvert\in\mathcal{M}^{+}\left(\X\times\mathcal{Y},\F\otimes\mathcal{G}\right)$
\end_inset

, by Tonelli's theorem,
\begin_inset Formula 
\[
\gamma_{1}\left(\lvert f\rvert\right)=\gamma_{2}\left(\lvert f\rvert\right)<\infty
\]

\end_inset

which implies, by Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:intFiniteFuncFinite"
plural "false"
caps "false"
noprefix "false"

\end_inset

, that
\begin_inset Formula 
\[
\nu^{y}\left(\lvert f\left(x,y\right)\rvert\right)<\infty
\]

\end_inset

and
\begin_inset Formula 
\[
\mu^{x}\left(\lvert f\left(x,y\right)\rvert\right)<\infty
\]

\end_inset

which gives us 
\begin_inset Formula $\left(i\right)$
\end_inset

 and 
\begin_inset Formula $\left(ii\right)$
\end_inset

.
 Next, note that
\begin_inset Formula 
\[
\lvert\nu^{y}\left(f\left(x,y\right)\right)\rvert\leq\nu^{y}\left(\lvert f\left(x,y\right)\rvert\right)<\infty
\]

\end_inset

and
\begin_inset Formula 
\[
\lvert\mu^{x}\left(f\left(x,y\right)\right)\rvert\leq\mu^{x}\left(\lvert f\left(x,y\right)\rvert\right)<\infty
\]

\end_inset

for all 
\begin_inset Formula $y\in\mathcal{Y}$
\end_inset

 by 
\begin_inset Formula $\left(i\right)$
\end_inset

 , 
\begin_inset Formula $\left(ii\right)$
\end_inset

 and Corollary 
\begin_inset CommandInset ref
LatexCommand ref
reference "cor:triangleIneqLebIntL1"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The measurabiltiy of 
\begin_inset Formula $x\to\lvert\nu^{y}\left(f\left(x,y\right)\right)\rvert$
\end_inset

 and 
\begin_inset Formula $y\to\lvert\mu^{x}\left(f\left(x,y\right)\right)\rvert$
\end_inset

 follows from the fact that 
\begin_inset Formula $x\to\nu^{y}\left(f^{\pm}\right)$
\end_inset

 and 
\begin_inset Formula $y\to\mu^{x}\left(f^{\pm}\right)$
\end_inset

 are measurable (and finite) by Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:partialIntegralMeasurability"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and so 
\begin_inset Formula $x\to\nu^{x}\left(f\left(x,y\right)\right)=x\to\nu^{x}\left(f^{+}\right)-\nu^{x}\left(f^{-}\right)$
\end_inset

 and 
\begin_inset Formula $y\to\mu^{x}\left(f\left(x,y\right)\right)=y\to\mu^{x}\left(f^{+}\right)-\mu^{x}\left(f^{-}\right)$
\end_inset

 are measurable by Corollary 
\begin_inset CommandInset ref
LatexCommand ref
reference "cor:examplesBinaryOpsMeasFunc"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Since the absolute value is continuous, our measurability results hold.
 Then, monotonicity of integration implies that 
\begin_inset Formula 
\[
\mu^{x}\lvert\nu^{y}\left(f\left(x,y\right)\right)\rvert<\infty\ \text{and}\ \nu^{y}\lvert\mu^{x}\left(f\left(x,y\right)\right)\rvert<\infty
\]

\end_inset

which gives is 
\begin_inset Formula $\left(iii\right)$
\end_inset

 and 
\begin_inset Formula $\left(iv\right).$
\end_inset

 Finally, to see 
\begin_inset Formula $\left(v\right)$
\end_inset

, you note that 
\begin_inset Formula $\gamma_{1}\left(f^{+}\right)=\gamma_{2}\left(f^{+}\right)$
\end_inset

 and 
\begin_inset Formula $\gamma_{1}\left(f^{-}\right)=\gamma_{2}\left(f^{-}\right)$
\end_inset

 by Tonelli.
 Then the result follows by subtracting these two equalities and apply linearity.
\end_layout

\begin_layout Subsection
Product sigma algebras and measures
\end_layout

\begin_layout Definition
\begin_inset CommandInset label
LatexCommand label
name "def:productMeasure"

\end_inset

Let 
\begin_inset Formula $\measurespace$
\end_inset

 and 
\begin_inset Formula $\left(\mathcal{Y},\mathcal{G},\nu\right)$
\end_inset

 be measure spaces and let 
\begin_inset Formula $\left(\X\times\mathcal{Y},\F\otimes\mathcal{G}\right)$
\end_inset

 be the product measurable space.
 Then a measure 
\begin_inset Formula $\mu\otimes\nu:\F\otimes\mathcal{G}\to\left[0,\infty\right]$
\end_inset

 is called a 
\emph on
product measure 
\emph default
if
\begin_inset Formula 
\[
\mu\otimes\nu\left(F\times G\right)=\mu\left(F\right)\nu\left(G\right)
\]

\end_inset

for all 
\begin_inset Formula $F\in\F,G\in\mathcal{G}.$
\end_inset


\end_layout

\begin_layout Standard
Of course, the way we have set this up, Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:tonelli"
plural "false"
caps "false"
noprefix "false"

\end_inset

(Tonelli) guarantees existence of this measure, since measures and integrals
 are equivalent.
 Uniqueness, when 
\begin_inset Formula $\mu$
\end_inset

 and 
\begin_inset Formula $\nu$
\end_inset

 are 
\begin_inset Formula $\sigma-$
\end_inset

finite, follows from the uniqueness theorem, as outlined in the proof of
 Tonelli.
 Note also the fact that the product of sigma finite measures is sigma finite.
 Tonelli (or Fubini) also tell us that for non-negative measurable (or integrabl
e) functions, the integral with respect to the product measure coincides
 with iterated integrals, at least when the measure spaces are 
\begin_inset Formula $\sigma-$
\end_inset

finite.
 That is to say
\begin_inset Formula 
\[
\lebInt{\mu\otimes\nu}f=\gamma_{1}\left(f\right)=\gamma_{2}\left(f\right)
\]

\end_inset

for any 
\begin_inset Formula $f\in\mathcal{M}^{+}\left(\X\times\mathcal{Y},\mathcal{F}\otimes\mathcal{G}\right)$
\end_inset

 (
\begin_inset Formula $f\in\Lp1{\mu\otimes v}$
\end_inset

).
\end_layout

\begin_layout Standard
To get some of the standard results on multiple integration in 
\begin_inset Formula $\R^{n}$
\end_inset

, we first need to do some legwork to characterize products of Borel 
\begin_inset Formula $\sigma-$
\end_inset

algebras.
 We begin first by generalizing the concept of a 
\begin_inset Formula $\sigma-$
\end_inset

algebra generated by a measurable function.
\end_layout

\begin_layout Definition
\begin_inset CommandInset label
LatexCommand label
name "def:sigmaMultipleMeasurableFunctions"

\end_inset

Let 
\begin_inset Formula $\X$
\end_inset

 be a set and let 
\begin_inset Formula $\left(\mathcal{Y}_{i},\mathcal{G}_{i}\right)$
\end_inset

 be a measurable spaces, for 
\begin_inset Formula $i\in I$
\end_inset

 where 
\begin_inset Formula $I$
\end_inset

 is an index set.
 Further, let 
\begin_inset Formula $\left\{ f_{i}\right\} _{i\in I}$
\end_inset

 , be a collection of functions 
\begin_inset Formula $f_{i}:\X\to\mathcal{Y}_{i}$
\end_inset

.
 Then, the 
\begin_inset Formula $\sigma-$
\end_inset

algebra generated by 
\begin_inset Formula $\left\{ f_{i}\right\} _{i\in I}$
\end_inset

 is 
\begin_inset Formula 
\[
\sigma\left(\left\{ f_{i}\right\} _{i\in I}\right):=\sigma\left(\bigcup_{i\in I}\sigma\left(f_{i}\right)\right)
\]

\end_inset

where 
\begin_inset Formula $\sigma\left(f_{i}\right)$
\end_inset

 is the usual definition of the sigma algebra generated by a function.
\end_layout

\begin_layout Remark*
When the 
\begin_inset Formula $I$
\end_inset

 is finite or countable, we simply write 
\begin_inset Formula $\sigma\left(f_{1},f_{2},\ldots\right)$
\end_inset

.
\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "prop:sigmaAlgebraGenCollectionSmallest"

\end_inset

Let 
\begin_inset Formula $\X$
\end_inset

 be a set and let 
\begin_inset Formula $\left(\mathcal{Y},\mathcal{G}\right)$
\end_inset

 be a measurable space.
 For any collection 
\begin_inset Formula $\left\{ f_{i}\right\} _{i\in I}$
\end_inset

 where 
\begin_inset Formula $I$
\end_inset

 is just some index set, 
\begin_inset Formula $\sigma\left(\left\{ f_{i}\right\} _{i\in I}\right)$
\end_inset

 is the smallest 
\begin_inset Formula $\sigma-$
\end_inset

algebra that makes every 
\begin_inset Formula $f_{i}$
\end_inset

 measurable.
\end_layout

\begin_layout Proof
Note that if 
\begin_inset Formula $\mathcal{F}$
\end_inset

 is some 
\begin_inset Formula $\sigma-$
\end_inset

algebra that makes 
\begin_inset Formula $f_{i}$
\end_inset

 measurable for all 
\begin_inset Formula $i\in I$
\end_inset

, then 
\begin_inset Formula $\sigma\left(f_{i}\right)\subseteq\mathcal{F}$
\end_inset

 which implies that 
\begin_inset Formula $\bigcup_{i\in I}\sigma\left(f_{i}\right)\subseteq\F$
\end_inset

 and the result follows.
\end_layout

\begin_layout Remark*
We can use the definition above to provide an alternate characterization
 of product 
\begin_inset Formula $\sigma-$
\end_inset

algebras.
 First note for measurable spaces 
\begin_inset Formula $\left(\X_{1},\mathcal{F}_{1}\right)$
\end_inset

 and 
\begin_inset Formula $\left(\X_{2},\mathcal{F}_{2}\right)$
\end_inset

 with the product space 
\begin_inset Formula $\left(\X_{1}\times\mathcal{\X}_{2},\F_{1}\otimes\F_{2}\right)$
\end_inset

, we have that the coordinate projections 
\begin_inset Formula $\pi_{1}$
\end_inset

 and 
\begin_inset Formula $\pi_{2}$
\end_inset

 defined as
\begin_inset Formula 
\[
\pi_{i}:\X_{1}\times\mathcal{\X}_{2}\to\X_{i}
\]

\end_inset

where 
\begin_inset Formula $\pi_{i}\left(x_{1},x_{2}\right)=x_{i}$
\end_inset

 for any 
\begin_inset Formula $i=1,2.$
\end_inset


\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "prop:altProductSigma"

\end_inset

Let 
\begin_inset Formula $\left(\X_{1},\F_{1}\right),\left(\X_{2},\F_{2}\right),$
\end_inset

 and 
\begin_inset Formula $\left(\mathcal{Y},\mathcal{G}\right)$
\end_inset

 be measurable spaces.
 Then
\end_layout

\begin_layout Proposition
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{enumerate}[label=(
\backslash
roman*),leftmargin=.1
\backslash
linewidth,rightmargin=.4
\backslash
linewidth]
\end_layout

\begin_layout Plain Layout


\backslash
item $
\backslash
sigma 
\backslash
left( 
\backslash
pi_1, 
\backslash
pi_2 
\backslash
right) = 
\backslash
mathcal{F}_1 
\backslash
otimes 
\backslash
mathcal{F}_2$
\end_layout

\begin_layout Plain Layout


\backslash
item  $T:
\backslash
left(
\backslash
mathcal{Y},
\backslash
mathcal{G}
\backslash
right) 
\backslash
to 
\backslash
left(
\backslash
X_{1}
\backslash
times
\backslash
mathcal{
\backslash
X}_{2},
\backslash
F_{1}
\backslash
otimes
\backslash
F_{2}
\backslash
right)$ is measurable if and only if the maps $
\backslash
pi_i 
\backslash
circ T :
\backslash
left(
\backslash
mathcal{Y},
\backslash
mathcal{G}
\backslash
right) 
\backslash
to 
\backslash
left(
\backslash
mathcal{X}_i, 
\backslash
mathcal{F}_i
\backslash
right)$ are measurable for $i=1,2$.
\end_layout

\begin_layout Plain Layout


\backslash
item If $ S:
\backslash
left(
\backslash
X_{1}
\backslash
times
\backslash
mathcal{
\backslash
X}_{2},
\backslash
F_{1}
\backslash
otimes
\backslash
F_{2}
\backslash
right) 
\backslash
to 
\backslash
left(
\backslash
mathcal{Y},
\backslash
mathcal{G}
\backslash
right)$ is measurable then the maps $x_1 
\backslash
to S(x_1,x_2)$ and $x_2 
\backslash
to S(x_1, x_2)$ are measurable for all $x_2 
\backslash
in 
\backslash
mathcal{X}_2$ and $x_1 
\backslash
in 
\backslash
mathcal{X}_1$, respectively.
\end_layout

\begin_layout Plain Layout


\backslash
end{enumerate}
\end_layout

\end_inset


\end_layout

\begin_layout Proof
For 
\begin_inset Formula $\left(i\right)$
\end_inset

, note that for any 
\begin_inset Formula $F\in\mathcal{F}_{1}$
\end_inset

, 
\begin_inset Formula $\pi_{1}^{-1}\left[F\right]=F\times\X_{2}\in\mathcal{F}_{1}\otimes\mathcal{F}_{2}$
\end_inset

 and so 
\begin_inset Formula $\pi_{1}$
\end_inset

 is measurable with respect to 
\begin_inset Formula $\mathcal{F}_{1}\otimes\mathcal{F}_{2}$
\end_inset

 and so by definition 
\begin_inset Formula $\sigma\left(\pi_{1}\right)\subseteq\mathcal{F}_{1}\otimes\mathcal{F}_{2}$
\end_inset

.
 Similarly, 
\begin_inset Formula $\sigma\left(\pi_{2}\right)\subseteq\mathcal{F}_{1}\otimes\mathcal{F}_{2}$
\end_inset

 and so 
\begin_inset Formula $\sigma\left(\pi_{1},\pi_{2}\right)\subseteq\mathcal{F}_{1}\otimes\mathcal{F}_{2}.$
\end_inset

 Conversely, for any 
\begin_inset Formula $F_{1}\in\mathcal{F}_{1}$
\end_inset

 and 
\begin_inset Formula $F_{2}\in\mathcal{F}_{2}$
\end_inset

, 
\begin_inset Formula 
\[
F_{1}\times F_{2}=\left(F_{1}\times\X_{2}\right)\cap\left(\X_{1}\times F_{2}\right)\in\sigma\left(\pi_{1},\pi_{2}\right)
\]

\end_inset

 and so 
\begin_inset Formula $\mathcal{F}_{1}\otimes\mathcal{F}_{2}=\sigma\left(\left\{ F_{1}\times F_{2}\mid F_{1}\in\F_{1},F_{2}\in\F_{2}\right\} \right)\subseteq\sigma\left(\pi_{1},\pi_{2}\right).$
\end_inset


\end_layout

\begin_layout Proof
Next, for 
\begin_inset Formula $\left(ii\right)$
\end_inset

, first note that if 
\begin_inset Formula $T$
\end_inset

 is measurable, then 
\begin_inset Formula $\pi_{i}\circ T$
\end_inset

 is measurable since 
\begin_inset Formula $\pi_{i}\in\mathcal{M}\left(\X_{1}\times\X_{2},\mathcal{F}_{1}\otimes\mathcal{F}_{2}\right)$
\end_inset

 by part 
\begin_inset Formula $\left(i\right)$
\end_inset

 and the composition of measurable functions is measurable.
 Conversely, if both 
\begin_inset Formula $\pi_{i}$
\end_inset

 and 
\begin_inset Formula $\pi\circ T$
\end_inset

 are measurable, then for any 
\begin_inset Formula $F_{1}\in\F_{1}$
\end_inset

 and 
\begin_inset Formula $F_{2}\in\F_{2}$
\end_inset


\begin_inset Formula 
\begin{align*}
T^{-1}\left[F_{1}\times F_{2}\right] & =T^{-1}\left[\left(F_{1}\times\X_{2}\right)\cap\left(\X_{1}\times F_{2}\right)\right]\\
 & =T^{-1}\left[\pi_{1}^{-1}\left[F_{1}\right]\cap\pi_{2}^{-1}\left[F_{2}\right]\right]\\
 & =\left(\pi_{1}\circ T\right)^{-1}\left[F_{1}\right]\cap\left(\pi_{2}\circ T\right)^{-1}\left[F_{2}\right]
\end{align*}

\end_inset

where both terms in the intersection are in 
\begin_inset Formula $\mathcal{G}$
\end_inset

 by the measurability of 
\begin_inset Formula $\pi_{i}\circ T$
\end_inset

.
 Then a standard generating class argument (Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:genericGeneratingClassArgument"
plural "false"
caps "false"
noprefix "false"

\end_inset

) yields the result.
\end_layout

\begin_layout Proof
Finally, note that 
\begin_inset Formula $x_{1}\to S\left(x_{1},x_{2}\right)$
\end_inset

 for some fixed 
\begin_inset Formula $x_{2}$
\end_inset

 can be thought of as the composition 
\begin_inset Formula $S\circ i_{x_{2}}$
\end_inset

 where 
\begin_inset Formula $i_{x_{2}}:\X_{1}\to\X_{1}\times\X_{2}$
\end_inset

 is given by 
\begin_inset Formula $i_{x_{2}}\left(x_{1}\right)=\left(x_{1},x_{2}\right)$
\end_inset

 .
 
\begin_inset Formula $S$
\end_inset

 is measurable by assumption and 
\begin_inset Formula $i_{x_{2}}^{-1}\left[F_{1}\times F_{2}\right]=F_{1}$
\end_inset

 and so 
\begin_inset Formula $i_{x_{2}}$
\end_inset

 is measurable by the standard generating class argument.
 A composition of measurable maps is measurable and the result follows.
 The argument for 
\begin_inset Formula $x_{2}\to S\left(x_{1},x_{2}\right)$
\end_inset

 is analagous.
\end_layout

\begin_layout Standard
This result allows us to show that our definition of the 
\begin_inset Formula $\sigma-$
\end_inset

algebra generated by multiple functions is quite natural.
\end_layout

\begin_layout Corollary
\begin_inset CommandInset label
LatexCommand label
name "cor:sigmaTupleisSigmaUnpack"

\end_inset

Let 
\begin_inset Formula $\X$
\end_inset

 be a set, let 
\begin_inset Formula $\left(\mathcal{Y}_{i},\mathcal{G}_{i}\right)$
\end_inset

 be a measurable spaces, for 
\begin_inset Formula $i\in\left\{ 1,2\right\} $
\end_inset

, and let 
\begin_inset Formula $\left(\mathcal{Y}_{1}\times\mathcal{Y}_{2},\mathcal{G}_{1}\otimes\mathcal{G}_{2}\right)$
\end_inset

 be the product measurable space.
 For any functions 
\begin_inset Formula $f_{1}:\X\to\mathcal{Y}_{1}$
\end_inset

 and 
\begin_inset Formula $f_{2}:\X\to\mathcal{Y}_{2}$
\end_inset

 , along with a function 
\begin_inset Formula $h\left(x\right)=\left(f_{1}\left(x\right),f_{2}\left(x\right)\right)$
\end_inset

, we have that 
\begin_inset Formula 
\[
\sigma\left(h\right)=\sigma\left(f_{1},f_{2}\right).
\]

\end_inset


\end_layout

\begin_layout Proof
Note by Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:altProductSigma"
plural "false"
caps "false"
noprefix "false"

\end_inset

, 
\begin_inset Formula $h$
\end_inset

 is measurable with respect to 
\begin_inset Formula $\sigma\left(f_{1},f_{2}\right)$
\end_inset

 since 
\begin_inset Formula $f_{1}=\pi_{1}\circ h$
\end_inset

 and 
\begin_inset Formula $f_{2}=\pi_{2}\circ h$
\end_inset

 are measurable with respect to 
\begin_inset Formula $\sigma\left(f_{1},f_{2}\right)$
\end_inset

 and so 
\begin_inset Formula $\sigma\left(h\right)\subseteq\sigma\left(f_{1},f_{2}\right).$
\end_inset

 Conversely, again by Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:altProductSigma"
plural "false"
caps "false"
noprefix "false"

\end_inset

, both 
\begin_inset Formula $f_{1}$
\end_inset

 and 
\begin_inset Formula $f_{2}$
\end_inset

 are measurable with respect to 
\begin_inset Formula $\sigma\left(h\right)$
\end_inset

 since 
\begin_inset Formula $h$
\end_inset

 is measurable with respect to 
\begin_inset Formula $\sigma\left(h\right)$
\end_inset

.
 Thus 
\begin_inset Formula $\sigma\left(f_{1},f_{2}\right)\subseteq\sigma\left(h\right).$
\end_inset


\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "prop:productGenerator"

\end_inset

Let 
\begin_inset Formula $\left(\X_{i},\F_{i}\right)$
\end_inset

 
\begin_inset Formula $i=1,2$
\end_inset

 be measurable spaces where there exist some collection of sets 
\begin_inset Formula $\mathcal{E}_{i}\subset\F_{i}$
\end_inset

 such that 
\begin_inset Formula $\X_{i}\in\mathcal{E}_{i}$
\end_inset

 and 
\begin_inset Formula 
\[
\sigma\left(\mathcal{E}_{i}\right)=\F_{i}.
\]

\end_inset

Then, letting 
\begin_inset Formula $\mathcal{E}:=\left\{ E_{1}\times E_{2}\mid E_{1}\in\mathcal{E}_{1},E_{2}\right\} $
\end_inset

, we have that 
\begin_inset Formula 
\[
\sigma\left(\mathcal{E}\right)=\F_{1}\otimes\F_{2}.
\]

\end_inset


\end_layout

\begin_layout Proof
Let 
\begin_inset Formula $\F:=\left\{ F_{1}\times F_{2}\mid F_{1}\in\F_{1},F_{2}\in\F_{2}\right\} .$
\end_inset

Obviously, 
\begin_inset Formula $\mathcal{E}\subseteq\mathcal{F}$
\end_inset

 and so 
\begin_inset Formula $\sigma\left(\mathcal{E}\right)\subseteq\sigma\left(\F\right)=\F_{1}\otimes\F_{2}.$
\end_inset

 To see the reverse inclusion, take the projections 
\begin_inset Formula $\pi_{i}:\X_{1}\times\X_{2}\to\X_{i}$
\end_inset

.
 We wish to show these functions are 
\begin_inset Formula $\sigma\left(\mathcal{E}\right)/\F_{i}$
\end_inset

 measurable.
 To that end, note that for any 
\begin_inset Formula $E\in\mathcal{E}_{1}$
\end_inset

, 
\begin_inset Formula $\pi_{1}^{-1}\left[E\right]=E\times\X_{2}\in\mathcal{E}\subseteq\sigma\left(\mathcal{E}\right)$
\end_inset

 and so a generating class argument tells us that 
\begin_inset Formula $\pi_{1}$
\end_inset

 is measurable as needed.
 An analagous argument establishes the measurability of 
\begin_inset Formula $\pi_{2}$
\end_inset

 and so 
\begin_inset Formula 
\[
\F_{1}\otimes\F_{2}=\sigma\left(\pi_{1},\pi_{2}\right)\subseteq\sigma\left(\mathcal{E}\right)
\]

\end_inset

where the equality is due to Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:altProductSigma"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:XinEnecessaryForProductGeneration"

\end_inset

In the proposition above, the requirement that 
\begin_inset Formula $\X_{i}\in\mathcal{E}_{i}$
\end_inset

 is necessary.
 Let 
\begin_inset Formula $\X_{1}=\X_{2}=\left\{ 1,2,3\right\} $
\end_inset

.
 Suppose then that 
\begin_inset Formula $\mathcal{E}_{1}=\left\{ \left\{ 1\right\} \right\} $
\end_inset

and 
\begin_inset Formula $\mathcal{E}_{2}=\left\{ \left\{ 2\right\} \right\} $
\end_inset

 and so
\begin_inset Formula 
\begin{align*}
\F_{1} & :=\sigma\left(\mathcal{E}_{1}\right)=\left\{ \left\{ 1,2,3\right\} ,\emptyset,\left\{ 1\right\} ,\left\{ 2,3\right\} \right\} \\
\F_{2} & :=\sigma\left(\mathcal{E}_{2}\right)=\left\{ \left\{ 1,2,3\right\} ,\emptyset,\left\{ 2\right\} ,\left\{ 1,3\right\} \right\} .
\end{align*}

\end_inset

Meanwhile, 
\begin_inset Formula $\mathcal{E}=\left\{ \left\{ \left(1,2\right)\right\} \right\} $
\end_inset

 and so
\begin_inset Formula 
\[
\sigma\left(\mathcal{E}\right)=\left\{ \left\{ 1,2,3\right\} \times\left\{ 1,2,3\right\} ,\emptyset,\left\{ \left(1,2\right)\right\} ,\left\{ \left(1,2\right)\right\} ^{C}\right\} 
\]

\end_inset

which doesnt contain 
\begin_inset Formula $\left\{ 1\right\} \times\left\{ 1,2,3\right\} \in\F_{1}\otimes\F_{2}.$
\end_inset


\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "prop:borelProductInclusion"

\end_inset

Let 
\begin_inset Formula $\left(\X_{1},\tau_{1}\right)$
\end_inset

 and 
\begin_inset Formula $\left(\X_{2},\tau_{2}\right)$
\end_inset

 be topological spaces with Borel sigma algebras 
\begin_inset Formula $\borel\left(\X_{1}\right)=\sigma\left(\tau_{1}\right)$
\end_inset

 and 
\begin_inset Formula $\borel\left(\X_{2}\right)=\sigma\left(\tau_{2}\right).$
\end_inset

 Then, letting 
\begin_inset Formula $\tau_{1}\otimes\tau_{2}$
\end_inset

 denote the box topology
\begin_inset Foot
status open

\begin_layout Plain Layout
which is equivalent to the product topology for finite products
\end_layout

\end_inset

i.e.
 the topology generated by 
\begin_inset Formula $\left\{ O_{1}\times O_{2}\mid O_{1}\in\tau_{1},O_{2}\in\tau_{2}\right\} $
\end_inset

, we have that 
\begin_inset Formula 
\[
\borel\left(\X_{1}\right)\otimes\borel\left(\X_{2}\right)\subseteq\borel\left(\X_{1}\times\X_{2}\right):=\sigma\left(\tau_{1}\otimes\tau_{2}\right).
\]

\end_inset

Moreover, in the case of Euclidean spaces
\begin_inset Formula 
\[
\borel\left(\R\right)\otimes\borel\left(\R\right)=\borel\left(\R^{2}\right).
\]

\end_inset


\end_layout

\begin_layout Proof
Observe that since 
\begin_inset Formula $\X_{i}\in\tau_{i}$
\end_inset

 
\begin_inset Formula $,i=1,2$
\end_inset

, 
\begin_inset Formula $\sigma\left(\left\{ O_{1}\times O_{2}\mid O_{1}\in\tau_{1},O_{2}\in\tau_{2}\right\} \right)=\borel\left(\X_{1}\right)\otimes\borel\left(\X_{2}\right)$
\end_inset

 by Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:productGenerator"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Note that the box topology 
\begin_inset Formula $\tau_{1}\otimes\tau_{2}=\tau\left(\left\{ O_{1}\times O_{2}\mid O_{1}\in\tau_{1},O_{2}\in\tau_{2}\right\} \right)$
\end_inset

; that is, it is the 
\emph on
topology generated by 
\begin_inset Formula $\left\{ O_{1}\times O_{2}\mid O_{1}\in\tau_{1},O_{2}\in\tau_{2}\right\} $
\end_inset

 
\emph default
(exactly analagous to a 
\begin_inset Formula $\sigma-$
\end_inset

algebra generated by a collection of sets).
 Since 
\begin_inset Formula $\left\{ O_{1}\times O_{2}\mid O_{1}\in\tau_{1},O_{2}\in\tau_{2}\right\} \subseteq\tau\left(\left\{ O_{1}\times O_{2}\mid O_{1}\in\tau_{1},O_{2}\in\tau_{2}\right\} \right)=\tau_{1}\otimes\tau_{2}$
\end_inset

, 
\begin_inset Formula 
\[
\borel\left(\X_{1}\right)\otimes\borel\left(\X_{2}\right)=\sigma\left(\left\{ O_{1}\times O_{2}\mid O_{1}\in\tau_{1},O_{2}\in\tau_{2}\right\} \right)\subseteq\sigma\left(\tau_{1}\otimes\tau_{2}\right)=\borel\left(\X_{1}\times\X_{2}\right)
\]

\end_inset

which is the first claim.
\end_layout

\begin_layout Proof
The second claim makes use of the separability of 
\begin_inset Formula $\R$
\end_inset

.
 We extend the argument from Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:openSetDisjointUnionInterval"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to 
\begin_inset Formula $\R^{2}$
\end_inset

 to show that any open set in 
\begin_inset Formula $\R^{2}$
\end_inset

 can be written as a countable union of open rectangles in 
\begin_inset Formula $\R^{2}$
\end_inset

.
 Take any open set 
\begin_inset Formula $U\subseteq\R^{2}$
\end_inset

.
 By definition, for any norm 
\begin_inset Formula $\lVert\cdot\rVert$
\end_inset

 on 
\begin_inset Formula $\R^{2}$
\end_inset

, for any 
\begin_inset Formula $x:=\left(x_{1},x_{2}\right)\in U$
\end_inset

 there exists some 
\begin_inset Formula $r>0$
\end_inset

 such that 
\begin_inset Formula 
\[
B_{\lVert\cdot\rVert}\left(x,r\right)\subset U.
\]

\end_inset

Since norms on 
\begin_inset Formula $\R^{2}$
\end_inset

 are all equivalent, let 
\begin_inset Formula $\lVert\cdot\rVert=\lVert\cdot\rVert_{\infty}$
\end_inset

 and notice that 
\begin_inset Formula $y\in B_{\lVert\cdot\rVert_{\infty}}\left(x,r\right)$
\end_inset

 if and ony if 
\begin_inset Formula $y\in\left(x_{1}-r,x_{1}+r\right)\times\left(x_{2}-r,x_{2}+r\right)$
\end_inset

.
 Now note that since the rationals are dense in 
\begin_inset Formula $\R$
\end_inset

 , we can find rational endpoints 
\begin_inset Formula $a_{i,x},b_{i,}$
\end_inset

 such that 
\begin_inset Formula $\left(a_{i,x},,b_{i,x}\right)\subseteq\left(x_{i}-r,x_{i}+r\right)$
\end_inset

 and 
\begin_inset Formula $x_{i}\in\left(a_{i,x},b_{i,x}\right).$
\end_inset

 Then, 
\begin_inset Formula 
\[
U=\bigcup_{x\in U}\left(a_{1,x},,b_{1,x}\right)\times\left(a_{2,x},,b_{2,x}\right).
\]

\end_inset

Since the endpoints are rational, there can only be countably many distinct
 such rectangles and so our claim follows.
 Now note that open rectangles are in 
\begin_inset Formula $\borel\left(\R\right)\otimes\borel\left(\R\right)$
\end_inset

 by definition, and so every open set in 
\begin_inset Formula $\R^{2}$
\end_inset

 is a countable union of sets in 
\begin_inset Formula $\borel\left(\R\right)\otimes\borel\left(\R\right).$
\end_inset

 Let the collection of open sets in 
\begin_inset Formula $\R^{2}$
\end_inset

 be denoted 
\begin_inset Formula $\mathcal{O}$
\end_inset

.
 Then
\begin_inset Formula 
\[
\mathcal{O}\subseteq\borel\left(\R\right)\otimes\borel\left(\R\right)\implies\borel\left(\R^{2}\right)\subseteq\borel\left(\R\right)\otimes\borel\left(\R\right)
\]

\end_inset

which completes the proof.
\end_layout

\begin_layout Standard
We can use the above result to construct classic counterexamples to Tonelli
 and Fubini when one of their hypotheses is not satsfied.
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:tonelliFailNonSigmaFinite"

\end_inset

Let 
\begin_inset Formula $\left(\left[0,1\right],\borel\left(\left[0,1\right]\right),\lambda\right)$
\end_inset

 and 
\begin_inset Formula $\left(\left[0,1\right],2^{\left[0,1\right]},\mu_{0}\right)$
\end_inset

 where 
\begin_inset Formula $\lambda$
\end_inset

 and 
\begin_inset Formula $\mu_{0}$
\end_inset

 are the Lebesgue and counting measures, respectively.
 Now consider the product space 
\begin_inset Formula $\left(\left[0,1\right]^{2},\borel\left(\left[0,1\right]\right)\otimes2^{\left[0,1\right]},\lambda\otimes\mu_{0}\right)$
\end_inset

 and observe that by a variant of the argument in Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:borelProductInclusion"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the diagonal set 
\begin_inset Formula $D=\left\{ \left(x,y\right)\in\left[0,1\right]^{2}\mid x=y\right\} \in\borel\left(\left[0,1\right]^{2}\right)=\borel\left(\left[0,1\right]\right)\otimes\borel\left(\left[0,1\right]\right)\subseteq\borel\left(\left[0,1\right]\right)\otimes2^{\left[0,1\right]}$
\end_inset

 since it is closed.
 Then
\begin_inset Formula 
\begin{align*}
\lambda^{x}\mu_{0}^{y}\left(\indicate_{D}\right) & =\lambda^{x}\left(1\left\{ x\in\left[0,1\right]\right\} \right)\\
 & =1\\
 & \neq0\\
 & =\mu_{0}^{y}\left(0\indicate\left\{ y\in\left[0,1\right]\right\} \right)\\
 & =\mu_{0}^{y}\lambda^{x}\left(\indicate_{D}\right).
\end{align*}

\end_inset

Note that 
\begin_inset Formula $\mu_{0}$
\end_inset

 is not 
\begin_inset Formula $\sigma-$
\end_inset

finite.
\end_layout

\begin_layout Subsection
Radon-Nikodym derivatives
\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "prop:prodRadonNikodymDerivatives"

\end_inset

Let 
\begin_inset Formula $\left(\X,\F\right)$
\end_inset

 and 
\begin_inset Formula $\left(\mathcal{Y},\mathcal{G}\right)$
\end_inset

 be measurable spaces with product space 
\begin_inset Formula $\left(\X\times\mathcal{Y},\F\otimes\mathcal{G}\right).$
\end_inset

 Let 
\begin_inset Formula $\mu_{1},\mu_{2}$
\end_inset

 be 
\begin_inset Formula $\sigma-$
\end_inset

finite measures on 
\begin_inset Formula $\F$
\end_inset

 such that 
\begin_inset Formula $\mu_{1}<<\mu_{2}$
\end_inset

.
 Similarly, let 
\begin_inset Formula $\nu_{1},\nu_{2}$
\end_inset

 be measures on 
\begin_inset Formula $\mathcal{G}$
\end_inset

 such that 
\begin_inset Formula $\nu_{1}<<\nu_{2}$
\end_inset

.
 Then 
\begin_inset Formula $\mu_{1}\otimes\nu_{1}$
\end_inset

 and 
\begin_inset Formula $\mu_{2}\otimes\nu_{2}$
\end_inset

 are 
\begin_inset Formula $\sigma-$
\end_inset

finite, 
\begin_inset Formula $\mu_{1}\otimes\mu_{2}<<\nu_{1}\otimes\nu_{2}$
\end_inset

 and
\begin_inset Formula 
\[
\frac{d\left(\mu_{1}\otimes\nu_{1}\right)}{d\left(\mu_{2}\otimes\nu_{2}\right)}\stackrel{\text{a.e}}{=}\frac{d\mu_{1}}{d\mu_{2}}\times\frac{d\nu_{1}}{d\nu_{2}}.
\]

\end_inset


\end_layout

\begin_layout Remark*
Note that the almost everywhere equality here holds with respect to both
 product measures.
\end_layout

\begin_layout Proof
Note that the 
\begin_inset Formula $\sigma-$
\end_inset

finiteness of the products follows from the fact that if 
\begin_inset Formula $\left\{ F_{i}\right\} _{i\in\N}\in\F$
\end_inset

 such that 
\begin_inset Formula $\bigcup_{i\in\N}F_{i}=\X$
\end_inset

 and 
\begin_inset Formula $\mu_{1}\left(F_{i}\right)<\infty$
\end_inset

 (and similarly for 
\begin_inset Formula $\left\{ G_{j}\right\} _{j\in\N}\in\mathcal{G})$
\end_inset

 then 
\begin_inset Formula $\bigcup_{i\in\N}\bigcup_{j\in\N}F_{i}\times G_{j}=\X\times\mathcal{Y}$
\end_inset

and 
\begin_inset Formula $\mu_{1}\left(F_{i}\right)\nu_{1}\left(G_{j}\right)<\infty$
\end_inset

.
 The same argument works for the other pair of measures.
 Then, notice that for any 
\begin_inset Formula $F\in\F\otimes\mathcal{G}$
\end_inset

, 
\begin_inset Formula 
\begin{align*}
\mu_{1}\otimes\nu_{1}\left(F\right) & =\mu_{1}^{x}\nu_{1}^{y}\left(\indicate_{F}\left(x,y\right)\right)\\
 & =\mu_{1}^{x}\nu_{2}^{y}\left(\indicate_{F}\left(x,y\right)\frac{d\nu_{1}}{d\nu_{2}}\right)\\
 & =\mu_{2}^{x}\left(\nu_{2}^{y}\left(\indicate_{F}\left(x\right)\frac{d\nu_{1}}{d\nu_{2}}\right)\frac{d\mu_{1}}{d\mu_{2}}\right)\\
 & =\mu_{2}^{x}\nu_{2}^{y}\left(\indicate_{F}\left(x\right)\frac{d\nu_{1}}{d\nu_{2}}\frac{d\mu_{1}}{d\mu_{2}}\right)
\end{align*}

\end_inset

where the first equality is Tonelli (and the uniquenes of product measures),
 the second is due the fact that 
\begin_inset Formula $y\to\indicate_{F}\left(x,y\right)$
\end_inset

 is a non-negative measurable function for every 
\begin_inset Formula $x\in\X$
\end_inset

 (by Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:partialFunctionMeasurability"
plural "false"
caps "false"
noprefix "false"

\end_inset

) and so Corollary 
\begin_inset CommandInset ref
LatexCommand ref
reference "cor:radonNikodymIntegral"
plural "false"
caps "false"
noprefix "false"

\end_inset

 applies.
 The third equality is similar: now we have the function 
\begin_inset Formula $x\to\nu_{2}^{y}\left(\indicate_{F}\left(x,y\right)\frac{d\nu_{1}}{d\nu_{2}}\right)$
\end_inset

 which is non-negative since the the integrand is non-negative function
 for every 
\begin_inset Formula $x\in\X$
\end_inset

.
 It's also measurable by Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:partialIntegralMeasurability"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and so Corollary 
\begin_inset CommandInset ref
LatexCommand ref
reference "cor:radonNikodymIntegral"
plural "false"
caps "false"
noprefix "false"

\end_inset

 again applies.
 Finally, we apply linearity (since 
\begin_inset Formula $\frac{d\mu_{1}}{d\mu_{2}}$
\end_inset

 is constant in 
\begin_inset Formula $y$
\end_inset

) in the last line.
 This completes the proof.
\end_layout

\begin_layout Standard
This result has a converse, in that for any 
\begin_inset Formula $\sigma-$
\end_inset

finite measure 
\begin_inset Formula $\nu$
\end_inset

 on 
\begin_inset Formula $\F\otimes\mathcal{G}$
\end_inset

 which is absolutely continuous with respect to a 
\begin_inset Formula $\sigma-$
\end_inset

finite product measure and whose Radon Nikodym derivative can be written
 as a product is itself a product measure.
 We make this precise with the following result.
\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "prop:prodRNConverse"

\end_inset

Let 
\begin_inset Formula $\left(\X,\F\right)$
\end_inset

 and 
\begin_inset Formula $\left(\mathcal{Y},\mathcal{G}\right)$
\end_inset

 be measurable spaces with product 
\begin_inset Formula $\left(\X\times\mathcal{Y},\F\otimes\mathcal{G}\right)$
\end_inset

.
 Let 
\begin_inset Formula $\nu_{1}$
\end_inset

 and 
\begin_inset Formula $\mu_{1}$
\end_inset

 be 
\begin_inset Formula $\sigma-$
\end_inset

finite measures on 
\begin_inset Formula $\F$
\end_inset

 such that 
\begin_inset Formula $\nu_{1}<<\mu_{1}$
\end_inset

 .
 Similarly, let 
\begin_inset Formula $\nu_{2}$
\end_inset

 and 
\begin_inset Formula $\mu_{2}$
\end_inset

 be 
\begin_inset Formula $\sigma-$
\end_inset

finite measures on 
\begin_inset Formula $\mathcal{G}$
\end_inset

 such that 
\begin_inset Formula $\nu_{2}<<\mu_{2}$
\end_inset

.
 Finally, let 
\begin_inset Formula $\gamma$
\end_inset

 be a measure on 
\begin_inset Formula $\F\otimes\mathcal{G}$
\end_inset

 such that 
\begin_inset Formula $\gamma<<\mu_{1}\otimes\mu_{2}$
\end_inset

 and
\begin_inset Formula 
\[
\frac{d\gamma}{d\mu_{1}\otimes\mu_{2}}\stackrel{\text{a.e}}{=}\frac{d\nu_{1}}{d\mu_{1}}\times\frac{d\nu_{2}}{d\mu_{2}}.
\]

\end_inset

Then 
\begin_inset Formula $\gamma=\nu_{1}\otimes\nu_{2}$
\end_inset

.
\end_layout

\begin_layout Proof
Note that for any 
\begin_inset Formula $A\in\F\otimes\mathcal{G}$
\end_inset


\begin_inset Formula 
\begin{align*}
\gamma\left(A\right) & =\mu_{1}^{x}\mu_{2}^{y}\left(\indicate_{A}\left(x,y\right)\frac{d\nu_{1}}{d\mu_{1}}\left(x\right)\frac{d\nu_{2}}{d\mu_{2}}\left(y\right)\right)\\
 & =\mu_{1}^{x}\nu_{2}^{y}\left(\indicate_{A}\left(x,y\right)\frac{d\nu_{1}}{d\mu_{1}}\left(x\right)\right)\\
 & =\nu_{2}^{y}\mu_{1}^{x}\left(\indicate_{A}\left(x,y\right)\frac{d\nu_{1}}{d\mu_{1}}\left(x\right)\right)\\
 & =\nu_{2}^{y}\nu_{1}^{x}\left(\indicate_{A}\left(x,y\right)\right)\\
 & =\nu_{2}\otimes\nu_{1}\left(A\right)
\end{align*}

\end_inset

where the second equality follows by Corollary
\begin_inset CommandInset ref
LatexCommand ref
reference "cor:radonNikodymIntegral"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the third equality by Tonelli, the fourth again by Corollary 
\begin_inset CommandInset ref
LatexCommand ref
reference "cor:radonNikodymIntegral"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Remark*
As we shall see, this results in this section are a measure theoretic justificat
ion for the probabilistic fact that two 
\emph on
absolutely continuous 
\emph default
random variables 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are 
\emph on
independent 
\emph default
if and only if we can factor their probability density functions.
\end_layout

\begin_layout Subsection
Integration by parts
\end_layout

\begin_layout Standard
Tonelli (or Fubini) gives us a generalization of integration by parts from
 elementary calculus.
 To see this, let 
\begin_inset Formula $F$
\end_inset

 and 
\begin_inset Formula $G$
\end_inset

 be Stieljes (that is, real valued, nondecreasing, and right continuous)
 functions on a compact set 
\begin_inset Formula $\left[a,b\right].$
\end_inset

 By Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:stieljesMeasure"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we have that the set functions 
\begin_inset Formula 
\begin{align*}
\mu\left(\left(x,y\right]\right) & :=F\left(y\right)-F\left(x\right)\\
\nu\left(\left(x,y\right]\right) & :=G\left(y\right)-G\left(x\right)
\end{align*}

\end_inset

for any 
\begin_inset Formula $a\leq x\leq y\leq b$
\end_inset

 extend to measures on 
\begin_inset Formula $\borel\left(\left[a,b\right]\right)$
\end_inset

.
 We can show that under mild regularity conditions, 
\begin_inset Formula 
\[
\lebInt{\mu}G+\lebInt{\nu}F=F\left(b\right)G\left(b\right)-F\left(a\right)G\left(a\right).
\]

\end_inset

This implies the 
\begin_inset Quotes eld
\end_inset

usual
\begin_inset Quotes erd
\end_inset

 integration by parts formula since 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hl{complete after finishing chapter on differentiation}
\end_layout

\end_inset

.
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:generalizedIntegrationByParts"

\end_inset


\begin_inset Argument 1
status open

\begin_layout Plain Layout
Integration by Parts
\end_layout

\end_inset

Let 
\begin_inset Formula $F$
\end_inset

 and 
\begin_inset Formula $G$
\end_inset

 be Stieljes functions on a compact set 
\begin_inset Formula $\left[a,b\right]$
\end_inset

.
 If the set of discontinuities of 
\begin_inset Formula $F$
\end_inset

 and 
\begin_inset Formula $G$
\end_inset

 are disjoint, then
\begin_inset Formula 
\[
\lebInt{\mu}G+\lebInt{\nu}F=F\left(b\right)G\left(b\right)-F\left(a\right)G\left(a\right).
\]

\end_inset


\end_layout

\begin_layout Proof
Note that 
\begin_inset Formula 
\begin{align*}
\lebInt{\mu}G & =\mu^{x}\left(G\left(x\right)\right)\\
 & =\mu^{x}\left(\nu\left(\left(a,x\right]\right)+G\left(a\right)\right)\\
 & =\mu^{x}\nu^{y}\left(\indicate\left\{ a<y\leq x\leq b\right\} \right)+G\left(a\right)\left(F\left(b\right)-F\left(a\right)\right)
\end{align*}

\end_inset

where the third equality uses linearity and the fact that 
\begin_inset Formula $\mu\left(\left(a,b\right]\right)=F\left(b\right)-F\left(a\right).$
\end_inset

 Similarly, we can write
\begin_inset Formula 
\begin{align*}
\lebInt{\nu}F & =\nu^{y}\left(F\left(y\right)\right)\\
 & =\nu^{y}\left(\mu\left(\left(a,y\right]\right)+F\left(a\right)\right)\\
 & =\nu^{y}\mu^{x}\left(\indicate\left\{ a<x\leq y\leq b\right\} \right)+F\left(a\right)\left(G\left(b\right)-G\left(a\right)\right).
\end{align*}

\end_inset

Now note that
\begin_inset Formula 
\begin{align}
\lebInt{\mu}G+\lebInt{\nu}F & =\mu^{x}\nu^{y}\left(\indicate\left\{ a<y\leq x\leq b\right\} \right)+\nu^{y}\mu^{x}\left(\indicate\left\{ a<x\leq y\leq b\right\} \right)+G\left(a\right)\left(F\left(b\right)-F\left(a\right)\right)+F\left(a\right)\left(G\left(b\right)-G\left(a\right)\right)\nonumber \\
 & =\mu^{x}\nu^{y}\left(\indicate\left\{ a<y\leq x\leq b\right\} +\indicate\left\{ a<x\leq y\leq b\right\} \right)+G\left(a\right)\left(F\left(b\right)-F\left(a\right)\right)+F\left(a\right)\left(G\left(b\right)-G\left(a\right)\right)\label{eq:muGPlusNuF}
\end{align}

\end_inset

where the second equality follows by Tonelli and linearity.
 We can expand upon the term inside the integral by noticing that 
\begin_inset Formula $\left\{ a<y\leq x\leq b\right\} =\underbrace{\left\{ a<y=x\leq b\right\} }_{=:A}\cup\underbrace{\left\{ a<y<x\leq b\right\} }_{=:B}$
\end_inset

 where the union is disjoint and so by Fact 
\begin_inset CommandInset ref
LatexCommand ref
reference "fact:indicatorFunctionsFiniteOperations"
plural "false"
caps "false"
noprefix "false"

\end_inset

, we know that 
\begin_inset Formula 
\[
\indicate\left\{ a<y\leq x\leq b\right\} =\indicate_{A}+\indicate_{B}.
\]

\end_inset

Further, 
\begin_inset Formula $\left\{ a<x\leq y\leq b\right\} =\left(a,b\right]^{2}\setminus B$
\end_inset

.
 Then
\begin_inset Formula 
\begin{align}
\mu^{x}\nu^{y}\left(\indicate\left\{ a<y\leq x\leq b\right\} +\indicate\left\{ a<x\leq y\leq b\right\} \right) & =\mu^{x}\nu^{y}\left(\indicate_{A}+\indicate_{B}+\indicate_{\left(a,b\right]^{2}\setminus B}\right)\nonumber \\
 & =\mu^{x}\nu^{y}\left(\indicate_{A}\right)+\mu\otimes\nu\left(\left(a,b\right]^{2}\right)\nonumber \\
 & =\mu^{x}\nu\left(\left\{ x\right\} \right)+\left(F\left(a\right)-F\left(b\right)\right)\left(G\left(a\right)-G\left(b\right)\right)\nonumber \\
 & =\left(F\left(a\right)-F\left(b\right)\right)\left(G\left(a\right)-G\left(b\right)\right)\label{eq:muNuXEqualYZero}
\end{align}

\end_inset

where the third equality is due to the fact that 
\begin_inset Formula $\mu\otimes\nu$
\end_inset

 is a product measure, and the last equality follows by our assumption that
 
\begin_inset Formula $F$
\end_inset

 and 
\begin_inset Formula $G$
\end_inset

 contain no common points of discontinuity and Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:stieljesSingleton"
plural "false"
caps "false"
noprefix "false"

\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hl{explain this better}
\end_layout

\end_inset

.
 Then, substituting 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:muNuXEqualYZero"
plural "false"
caps "false"
noprefix "false"

\end_inset

 into 
\begin_inset CommandInset ref
LatexCommand eqref
reference "eq:muGPlusNuF"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and doing some algebra yields the result.
\end_layout

\begin_layout Standard
An interesting application of this result is showing that the integral of
 a Stieljes function 
\begin_inset Formula $F$
\end_inset

 under the measure induced by 
\begin_inset Formula $F$
\end_inset

 is simply 
\begin_inset Formula $\frac{F\left(b\right)^{2}-F\left(a\right)^{2}}{2},$
\end_inset

 which follows simply by applying the above theorem where 
\begin_inset Formula $F=G.$
\end_inset

 In probability theory, this is a special case of the fact that a cumulative
 distribution function of a random variable is itself uniformly distributed
 on 
\begin_inset Formula $\left[0,1\right]$
\end_inset

.
 We shall establish this fact in Part II of these notes.
\end_layout

\begin_layout Subsection
Area under the graph of a function.
\end_layout

\begin_layout Standard
In elementary calculus, we understood the ordinary (Riemann) integral of
 a bounded function 
\begin_inset Formula $f$
\end_inset

 on a compact interval 
\begin_inset Formula $\left[a,b\right]$
\end_inset

 as representing the area of under the graph of 
\begin_inset Formula $f$
\end_inset

 on 
\begin_inset Formula $\left[a,b\right].$
\end_inset

 The Riemann theory formalized this by partitioning the interval 
\begin_inset Formula $\left[a,b\right]$
\end_inset

 into subintervals and computing the integral of step functions which were
 constant on each subinterval in the partition.
 We can do this more generally with Lebesgue integrals as well.
 That is to say, we can show that for a non-negative measurable function
 
\begin_inset Formula $f:\R\to\R$
\end_inset


\begin_inset Formula 
\[
\lebInt{\lambda}f=\lambda^{2}\left(\left\{ \left(x,t\right)\in\R^{2}\mid0\leq t<f\left(x\right)\right\} \right)
\]

\end_inset

where 
\begin_inset Formula $\lambda^{2}$
\end_inset

 is the 2-dimensional Lebesgue measure 
\begin_inset Formula $\lambda\otimes\lambda$
\end_inset

 on 
\begin_inset Formula $\borel\left(\R^{2}\right)$
\end_inset

.
 In fact, we can establish this result more generally for other 
\begin_inset Formula $\sigma-$
\end_inset

finite measures using Tonelli's theorem.
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:areaUnderGraphLebesgue"

\end_inset

Let 
\begin_inset Formula $\measurespace$
\end_inset

 be a 
\begin_inset Formula $\sigma-$
\end_inset

finite measure space and let 
\begin_inset Formula $f\in\nonnegMeasurableFunctions.$
\end_inset

 Then 
\begin_inset Formula $\left\{ \left(x,t\right)\in\X\times\R\mid f\left(x\right)>t\geq0\right\} \in\F\otimes\borel\left(\R\right)$
\end_inset

 and
\begin_inset Formula 
\[
\lebInt{\mu}f=\lambda^{t}\left(\mu^{x}\left(\left\{ f\left(x\right)>t\right\} \right)\indicate\left\{ t\geq0\right\} \right)=\lambda\otimes\mu\left(\left\{ \left\{ f\left(x\right)>t\geq0\right\} \right\} \right)
\]

\end_inset


\end_layout

\begin_layout Proof
First notice that function 
\begin_inset Formula $T\left(x,t\right)=f\left(x\right)-t$
\end_inset

 is 
\begin_inset Formula $\F\otimes\mathcal{\borel\left(\R\right)}/\borel\left(\R\right)$
\end_inset

 measurable.
 To see this, define 
\begin_inset Formula $g\left(x,t\right)=f\left(x\right)$
\end_inset

 and notice that for any 
\begin_inset Formula $B\in\borel\left(\R\right):$
\end_inset


\begin_inset Formula $g^{-1}\left[B\right]=f^{-1}\left[B\right]\times\R\in\mathcal{F}\otimes\borel\left(\R\right)$
\end_inset

.
 Similarly, letting 
\begin_inset Formula $h\left(x,t\right)=t$
\end_inset

, we have that 
\begin_inset Formula $h^{-1}\left[B\right]=\R\times B\in\F\otimes\borel\left(\R\right)$
\end_inset

.
 Then, using the fact that linear combinations of Borel measurable functions
 are Borel measurable, the function 
\begin_inset Formula $T$
\end_inset

 is 
\begin_inset Formula $\F\otimes\borel\left(\R\right)/\borel\left(\R\right)$
\end_inset

 measurable.
 Notice then that 
\begin_inset Formula $T^{-1}\left[\left(0,\infty\right)\right]=\left\{ \left(x,t\right)\in\R^{2}\mid f\left(x\right)>t\right\} $
\end_inset

 is measurable.
 Further, the set 
\begin_inset Formula $\left\{ \left(x,t\right)\in\R^{2}\mid t\geq0\right\} =\X\times\left[0,\infty\right)\in\F\otimes\borel\left(\R\right).$
\end_inset

 Then, 
\begin_inset Formula 
\[
\left\{ \left(x,t\right)\in\X\times\R\mid f\left(x\right)>t\geq0\right\} =T^{-1}\left[\left(0,\infty\right)\right]\cap\left(\X\times\left[0,\infty\right)\right)\in\F\otimes\borel\left(\R\right)
\]

\end_inset

and the first result follows.
 Then,
\begin_inset Formula 
\begin{align*}
\lebInt{\mu}f & =\mu^{x}\left(\lambda^{t}\left(\indicate\left\{ 0\le t<f\left(x\right)\right\} \right)\right)\\
 & =\lambda^{t}\left(\indicate\left\{ t\geq0\right\} \mu^{x}\left(\indicate\left\{ f\left(x\right)>t\right\} \right)\right)\\
 & =\lambda^{t}\left(\mu^{x}\left(\left\{ f\left(x\right)>t\right\} \right)\indicate\left\{ t>0\right\} \right)
\end{align*}

\end_inset

where in the second equality we used Tonelli (
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:tonelli"
plural "false"
caps "false"
noprefix "false"

\end_inset

), linearity, and the fact that 
\begin_inset Formula $\indicate_{A\cap B}=\indicate_{A}\indicate_{B}.$
\end_inset

 Observe that Tonelli can be applied here since 
\begin_inset Formula $\indicate\left\{ 0<t<f\left(x\right)\right\} \in\mathcal{M}^{+}\left(\X\times\R,\mathcal{F}\otimes\borel\left(\R\right)\right)$
\end_inset

 and both 
\begin_inset Formula $\mu$
\end_inset

 and 
\begin_inset Formula $\lambda$
\end_inset

 are 
\begin_inset Formula $\sigma-$
\end_inset

finite.
 Note that Tonelli's theorem also implies that 
\begin_inset Formula 
\[
\lambda^{t}\left(\mu^{x}\left(\indicate\left\{ f\left(x\right)>t\geq0\right\} \right)\right)=\lambda\otimes\mu\left(\left\{ \left\{ f\left(x\right)>t\geq0\right\} \right\} \right).
\]

\end_inset


\end_layout

\begin_layout Standard

\end_layout

\begin_layout Section
The Lebesgue measure on 
\begin_inset Formula $\R^{n}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hl{Formalize extension of Fubini etc to $n$ dimension}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
It should be easy to guess that by induction, we can extend the construction
 of product measures to products of 
\begin_inset Formula $n$
\end_inset


\begin_inset Formula $\sigma-$
\end_inset

finite measure spaces.
 That is, for spaces 
\begin_inset Formula $\left\{ \left(\X_{i},\mathcal{F}_{i},\mu_{i}\right)\right\} _{i=1}^{n}$
\end_inset

 , we can define the product space 
\begin_inset Formula $\left(\prod_{i=1}^{n}\X_{i},\otimes_{i}\F_{i}\right)$
\end_inset

 and show that for sigme finite measures 
\begin_inset Formula $\mu_{i}$
\end_inset

 on 
\begin_inset Formula $\F_{i}$
\end_inset

, there exists a unique product measure 
\begin_inset Formula $\otimes_{i=1}^{n}\mu_{i}$
\end_inset

 such that for 
\begin_inset Formula $\prod F_{i}$
\end_inset

, 
\begin_inset Formula $F_{i}\in\F_{i}$
\end_inset


\begin_inset Formula 
\[
\otimes_{i=1}^{n}\mu_{i}\left(\prod_{i=1}^{n}F_{i}\right)=\prod_{i=1}^{n}\mu_{i}\left(F_{i}\right).
\]

\end_inset

This requires us to use the canonical identification between 
\begin_inset Formula $\prod_{i=1}^{n}\X_{i}$
\end_inset

 and 
\begin_inset Formula $\left(\prod_{i=1}^{n-1}\X_{i}\right)\times\X_{n}$
\end_inset

 and the fact that the product of 
\begin_inset Formula $\sigma-$
\end_inset

finite measures is 
\begin_inset Formula $\sigma-$
\end_inset

finite.
 We can also similarly extend the Fubini-Tonelli theorems, so that for any
 permutation 
\begin_inset Formula $\sigma:\left\{ 1,2,\dots,n\right\} \to\left\{ 1,2,\ldots,n\right\} $
\end_inset

 and 
\begin_inset Formula $f\in\mathcal{M}^{+}\left(\prod_{i=1}^{n}\X_{i},\otimes_{i}\F_{i}\right)$
\end_inset

 (or 
\begin_inset Formula $f\in\Lp1{\otimes_{i=1}^{n}\mu_{i}}$
\end_inset

)
\begin_inset Formula 
\[
\otimes_{i=1}^{n}\mu_{i}\left(f\right)=\mu_{\sigma\left(1\right)}\left(\mu_{\sigma\left(2\right)}\ldots\left(\mu_{\sigma\left(n\right)}\left(f\right)\right)\right).
\]

\end_inset


\end_layout

\begin_layout Standard
Using the above facts, we can easily construct the Lebesgue measure 
\begin_inset Formula $\lambda^{n}$
\end_inset

 on 
\begin_inset Formula $\borel\left(\R^{n}\right)=\otimes_{i=1}^{n}\borel\left(\R\right)$
\end_inset

 as the product measure 
\begin_inset Formula $\otimes_{i=1}^{n}\lambda$
\end_inset

, where uniqueness is guaranteed by the 
\begin_inset Formula $\sigma-$
\end_inset

finiteness of 
\begin_inset Formula $\lambda$
\end_inset

.
 Equivalently, we can construct the Lebesgue measure using the Caratheodory
 approach, by defining 
\begin_inset Formula $\mathcal{L}^{n}=\left\{ \prod_{i=1}^{n}\left(a_{i},b_{i}\right]\mid\left(a_{i},b_{i}\right]\in\mathcal{L}\right\} $
\end_inset

, and restricting the canonical outer measure
\begin_inset Formula 
\[
\lambda_{*}^{n}\left(A\right)=\inf\left\{ \sum_{j=1}^{\infty}\lambda_{1}^{n}\left(L_{j}\right)\mid A\subseteq\bigcup_{j\in\N}L_{j},L_{j}\in\mathcal{L}^{n}\right\} 
\]

\end_inset

to the Lebesgue 
\begin_inset Formula $\sigma-$
\end_inset

algebra 
\begin_inset Formula $\mathcal{C}\left(\lambda_{*}^{n}\right)$
\end_inset

.
 This works because the collection 
\begin_inset Formula $\mathcal{L}^{n}$
\end_inset

 can be shown to be a semi-ring and 
\begin_inset Formula $\lambda_{1}^{n}:\mathcal{L}^{n}\to\left[0,\infty\right]$
\end_inset

 (here 
\begin_inset Formula $\lambda_{1}^{n}\left(\prod_{i=1}^{n}L_{i}\right)=\prod_{i=1}^{n}\lambda_{1}\left(L_{i}\right)$
\end_inset

where 
\begin_inset Formula $L_{i}\in\mathcal{L}$
\end_inset

) can be shown to satisfy the requirements of Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:semiRingCaratheodoryExtn"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Subsection
Basic properties of the Lebesgue measure
\begin_inset CommandInset label
LatexCommand label
name "subsec:lebesgueRNproperties"

\end_inset


\end_layout

\begin_layout Standard
The first property of the Lebesgue measure that we establish is a generalization
 of Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:outerMeasureScales"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to 
\begin_inset Formula $n-$
\end_inset

dimensions.
\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "prop:outerMeasureScalesNDim"

\end_inset

For 
\begin_inset Formula $\delta\neq0$
\end_inset

 and any 
\begin_inset Formula $A\in\borel\left(\R^{n}\right)$
\end_inset

 we have 
\begin_inset Formula $\delta B\in\borel\left(\R^{n}\right)$
\end_inset

.
 Further, for any 
\begin_inset Formula $A\subseteq\R^{n}$
\end_inset


\begin_inset Formula 
\[
\lambda_{*}^{n}\left(\delta A\right)=\lvert\delta\rvert^{n}\lambda_{*}^{n}\left(A\right).
\]

\end_inset


\end_layout

\begin_layout Proof
Measurability follows by a simple generating class argument as in the Lemma
 (or alternatively, let 
\begin_inset Formula $f\left(x\right)=\frac{x}{\delta}$
\end_inset

 and notice that 
\begin_inset Formula $f^{-1}$
\end_inset

is a continuous function and 
\begin_inset Formula $f^{-1}\left[B\right]=\delta B\in\borel\left(\R\right)$
\end_inset

).
 Next, notice that for 
\begin_inset Formula $n=1$
\end_inset

 this result is result is Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:outerMeasureScales"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Suppose the result holds for 
\begin_inset Formula $n-1$
\end_inset

.
 Let 
\begin_inset Formula $B\in\borel\left(\R^{n-1}\right)$
\end_inset

 and 
\begin_inset Formula $A\in\borel\left(\R\right)$
\end_inset

, then 
\begin_inset Formula 
\begin{align*}
\lambda^{n}\left(\delta\left(B\times A\right)\right) & =\lambda^{n}\left(\left(\delta B\right)\times\left(\delta A\right)\right)\\
 & =\lambda^{n-1}\left(\delta B\right)\lambda\left(\delta A\right)\\
 & =\lvert\delta^{n}\rvert\lambda^{n-1}\left(B\right)\lambda\left(A\right)\\
 & =\lvert\delta^{n}\rvert\lambda^{n}\left(B\times A\right).
\end{align*}

\end_inset

By the identification between 
\begin_inset Formula $\R^{n-1}\times\R$
\end_inset

 and 
\begin_inset Formula $\R^{n}$
\end_inset

, our scaling result holds on 
\begin_inset Formula $\mathcal{L}^{n}$
\end_inset

.
 Extending the proof to any arbitrary set 
\begin_inset Formula $A\subseteq\R^{n}$
\end_inset

proceeds exactly as in Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:outerMeasureScales"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Corollary
\begin_inset CommandInset label
LatexCommand label
name "cor:dilationIntegral"

\end_inset

Let 
\begin_inset Formula $\delta\neq0$
\end_inset

 be arbitrary.
 For any 
\begin_inset Formula $f\in\mathcal{M}^{+}\left(\R^{n},\borel\left(\R^{n}\right)\right)$
\end_inset

 (or 
\begin_inset Formula $f\in\Lp1{\lambda^{n}})$
\end_inset


\begin_inset Formula 
\[
\lebInt{\lambda^{n}}{f\left(\delta x\right)}=\frac{1}{\lvert\delta^{n}\rvert}\lebInt{\lambda^{n}}{f\left(x\right)}.
\]

\end_inset


\end_layout

\begin_layout Proof
Let 
\begin_inset Formula $g\left(x\right)=\delta x$
\end_inset

 and notice that by Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:outerMeasureScalesNDim"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the image measure 
\begin_inset Formula $\lambda^{n}g$
\end_inset

 agrees with the measure 
\begin_inset Formula $\frac{1}{\lvert\delta^{n}\rvert}\lambda^{n}$
\end_inset

 on all Borel sets.
 By the change of variables formula in Corollary 
\begin_inset CommandInset ref
LatexCommand ref
reference "cor:changeOfVariables"
plural "false"
caps "false"
noprefix "false"

\end_inset

, 
\begin_inset Formula $\lebInt{\lambda^{n}}{f\left(\delta x\right)}=\lebInt{\lambda^{n}g}f=\frac{1}{\lvert\delta^{n}\rvert}\lebInt{\lambda^{n}}f.$
\end_inset


\end_layout

\begin_layout Standard
We also have translation invariance, which is the analogue of Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:outerMeasureTranslationInvariant"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "prop:outerMeasureTranslationInvariantNDim"

\end_inset

Let 
\begin_inset Formula $A\subseteq\R^{n}$
\end_inset

 be an arbitrary set.
 Then the translated set 
\begin_inset Formula $A+t:=\left\{ a+t\mid a\in A\right\} $
\end_inset

 has Lebesgue outer measure
\begin_inset Formula 
\[
\lambda_{*}^{n}\left(A+t\right)=\lambda_{*}^{n}\left(A\right)
\]

\end_inset

for all 
\begin_inset Formula $t\in\R$
\end_inset

.
 Moreover, for any set 
\begin_inset Formula $A\in\borel\left(\R^{n}\right),$
\end_inset


\begin_inset Formula $A+t\in\borel\left(\R^{n}\right).$
\end_inset


\end_layout

\begin_layout Proof
Again, the measurability result is a generating class argument (or let 
\begin_inset Formula $f\left(x\right)=x-t$
\end_inset

...).
 The result holds for 
\begin_inset Formula $n=1$
\end_inset

 by the Lemma.
 Suppose it holds for 
\begin_inset Formula $n-1$
\end_inset

 .
 Letting 
\begin_inset Formula $B\in\borel\left(\R^{n-1}\right)$
\end_inset

 and 
\begin_inset Formula $A\in\borel\left(\R\right)$
\end_inset

, we have 
\begin_inset Formula 
\begin{align*}
\lambda^{n}\left(\left(B\times A\right)+t\right) & =\lambda^{n}\left(\left(B+t\right)\times\left(A+t\right)\right)\\
 & =\lambda^{n-1}\left(B+t\right)\lambda\left(A+t\right)\\
 & =\lambda^{n-1}\left(B\right)\lambda\left(A\right)\\
 & =\lambda^{n}\left(B\times A\right).
\end{align*}

\end_inset

Extending this to the general case follows exactly as in the Lemma.
\end_layout

\begin_layout Corollary
\begin_inset CommandInset label
LatexCommand label
name "cor:translationInvarianceIntegral"

\end_inset

Let 
\begin_inset Formula $t\in\R$
\end_inset

 be arbitrary.
 For any 
\begin_inset Formula $f\in\mathcal{M}^{+}\left(\R^{n},\borel\left(\R^{n}\right)\right)$
\end_inset

 (or 
\begin_inset Formula $f\in\Lp1{\lambda^{n}})$
\end_inset


\begin_inset Formula 
\[
\lebInt{\lambda^{n}}{f\left(x+t\right)}=\lebInt{\lambda^{n}}{f\left(x\right)}.
\]

\end_inset


\end_layout

\begin_layout Proof
Let 
\begin_inset Formula $g\left(x\right)=x+t$
\end_inset

 and notice that by Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:outerMeasureTranslationInvariantNDim"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the image measure 
\begin_inset Formula $\lambda^{n}g$
\end_inset

 and 
\begin_inset Formula $\lambda^{n}$
\end_inset

 agree on all Borel sets.
 But recall that by the general change of variables formula in Corollary
\begin_inset CommandInset ref
LatexCommand ref
reference "cor:changeOfVariables"
plural "false"
caps "false"
noprefix "false"

\end_inset

, 
\begin_inset Formula $\lebInt{\lambda^{n}}{f\left(x+t\right)}=\lebInt{\lambda^{n}g}f=\lebInt{\lambda^{n}}f.$
\end_inset


\end_layout

\begin_layout Standard
These two results are rather banal because they don't offer much additional
 insight over and above the corresponding results for the usual Lebesgue
 measure on the line.
 In order to derive some interesting properties of 
\begin_inset Formula $\lambda^{n}$
\end_inset

, we need to exploit the rich geometric structure of the Euclidean space
 and the functions that act on it.
 In order to do so, we need to review some basic linear algebra.
 Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Determinants"
plural "false"
caps "false"
noprefix "false"

\end_inset

 on determinants is key here; please re-read this section carefully before
 we embark on the next result.
\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:changeOfVariablesAffineElementary"

\end_inset

Let 
\begin_inset Formula $T:\R^{n}\to\R^{n}$
\end_inset

 be an elementary map and let 
\begin_inset Formula $f\in\mathcal{M}^{+}\left(\R,\borel\left(\R\right)\right)$
\end_inset

 (or 
\begin_inset Formula $f\in\Lp1{\lambda^{n}}$
\end_inset

).
 Then 
\begin_inset Formula $f\circ T\in\mathcal{M}^{+}\left(\R,\F\right)$
\end_inset

 (
\begin_inset Formula $f\circ T\in\Lp1{\lambda^{n}}$
\end_inset

 and 
\begin_inset Formula 
\[
\lvert\det\left(T\right)\rvert\lebInt{\lambda^{n}}{f\circ T}=\lebInt{\lambda^{n}}f.
\]

\end_inset


\end_layout

\begin_layout Proof
The measurability is trivial and so first, suppose 
\begin_inset Formula $T$
\end_inset

 is the row scaling operator, and note that if 
\begin_inset Formula $T\left(x_{1},\ldots,x_{k},\ldots,x_{n}\right)=\left(x_{1},\ldots,cx_{k},\ldots x_{n}\right),$
\end_inset

with 
\begin_inset Formula $c\ne0,$
\end_inset

then 
\begin_inset Formula $\det\left(T\right)=c$
\end_inset

 and so by Tonelli (Fubini)
\begin_inset Formula 
\begin{align*}
\lambda^{n}\left(f\circ T\right) & =\lambda^{x_{-k}}\lambda^{x_{k}}\left(f\left(x_{1},\ldots,cx_{k},\ldots,x_{n}\right)\right)\\
 & =\frac{1}{\lvert c\rvert}\lambda^{x_{-k}}\lambda^{x_{k}}\left(f\left(x_{1},\ldots,x_{k},\ldots x_{n}\right)\right)\\
 & =\frac{1}{\lvert c\rvert}\lambda^{n}\left(f\right)
\end{align*}

\end_inset

where in the second line we used Corollary 
\begin_inset CommandInset ref
LatexCommand ref
reference "cor:dilationIntegral"
plural "false"
caps "false"
noprefix "false"

\end_inset

 for 
\begin_inset Formula $n=1$
\end_inset

.
 Next, suppose that 
\begin_inset Formula $T$
\end_inset

 is the row switching operator which as 
\begin_inset Formula $\det\left(T\right)=-1$
\end_inset

 and clearly Tonelli-Fubini imply that the integral is invariant under any
 permutation of indices and so the result follows.
 Finally, suppose that 
\begin_inset Formula $T$
\end_inset

 is the row replacement operator i.e 
\begin_inset Formula $T\left(x_{1},\ldots,x_{l},\ldots x_{k},\ldots,x_{n}\right)=\left(x_{1},\ldots,x_{l}+cx_{k},\ldots x_{k},\ldots,x_{n}\right)$
\end_inset

.
 Again, by Tonelli (Fubini)
\begin_inset Formula 
\begin{align*}
\lambda^{n}\left(f\circ T\right) & =\lambda^{x_{-l}}\lambda^{x_{l}}\left(f\left(x_{1},\ldots,x_{l}+cx_{k},\ldots,x_{n}\right)\right)\\
 & =\lambda^{x_{-l}}\lambda^{x_{l}}\left(f\left(x_{1},\ldots,x_{l},\ldots x_{k},\ldots,x_{n}\right)\right)\\
 & =\lambda^{n}\left(f\right)
\end{align*}

\end_inset

which establishes the result since 
\begin_inset Formula $\det\left(T\right)=1.$
\end_inset


\end_layout

\begin_layout Lemma
\begin_inset CommandInset label
LatexCommand label
name "lem:changeOfVariablesLinear"

\end_inset

Let 
\begin_inset Formula $T:\R^{n}\to\R^{n}$
\end_inset

 be an invertbe linear map and let 
\begin_inset Formula $f\in\mathcal{M}^{+}\left(\R,\borel\left(\R\right)\right)$
\end_inset

 (or 
\begin_inset Formula $f\in\Lp1{\lambda^{n}}$
\end_inset

).
 Then 
\begin_inset Formula $f\circ T\in\mathcal{M}^{+}\left(\R,\F\right)$
\end_inset

 (
\begin_inset Formula $f\circ T\in\Lp1{\lambda^{n}}$
\end_inset

 and
\begin_inset Formula 
\[
\lvert\det\left(T\right)\rvert\lambda^{n}\left(f\circ T\right)=\lambda^{n}\left(f\right).
\]

\end_inset


\end_layout

\begin_layout Proof
The measurability is again trivial.
 Since the matrices of arbitrary invertible maps are the product of elementary
 matrices, all we need to show is that for two elementary matrices 
\begin_inset Formula $E_{1},E_{2}$
\end_inset

 , the product matrix 
\begin_inset Formula $E=E_{1}E_{2}$
\end_inset

 satisfies the conclusion of the theorem.
 The general claim then follows by induction.
 Clearly, 
\begin_inset Formula 
\begin{align*}
\lvert\det\left(E\right)\rvert\lambda^{n}\left(f\circ E\right) & =\lvert\det\left(E_{1}\right)\rvert\lvert\det\left(E_{2}\right)\rvert\lambda^{n}\left(\left(f\circ E_{1}\right)\circ E_{2}\right)\\
 & =\lvert\det\left(E_{1}\right)\rvert\lambda^{n}\left(f\circ E_{1}\right)\\
 & =\lambda^{n}\left(f\right)
\end{align*}

\end_inset

where the first equality uses the associativity of composition and Proposition
 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:detProduct"
plural "false"
caps "false"
noprefix "false"

\end_inset

, the second equality uses Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:changeOfVariablesAffineElementary"
plural "false"
caps "false"
noprefix "false"

\end_inset

 applied to 
\begin_inset Formula $T=E_{2}$
\end_inset

 and 
\begin_inset Formula $f=f\circ E_{1}$
\end_inset

.
 The last equality is yet another application of the previous lemma.
\end_layout

\begin_layout Standard
Note that a corollary of this result is the fact that the Lebesgue measure
 is rotationally invariant.
\end_layout

\begin_layout Corollary
\begin_inset CommandInset label
LatexCommand label
name "cor:lebesgueRotationalInvariance"

\end_inset

Let 
\begin_inset Formula $R:\R^{n}\to\R^{n}$
\end_inset

 be a rotation.
 Then for any Borel set 
\begin_inset Formula $B\in\borel\left(\R^{n}\right)$
\end_inset


\begin_inset Formula 
\[
\lambda^{n}\left(R\left(B\right)\right)=\lambda^{n}\left(B\right).
\]

\end_inset


\end_layout

\begin_layout Proof
Note that rotations are orthogonal linear maps in that 
\begin_inset Formula $RR^{T}=I$
\end_inset

 and so 
\begin_inset Formula 
\[
\det\left(R\right)=\frac{1}{\det\left(R^{T}\right)}.
\]

\end_inset

But recall from Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "prop:detTranspose"
plural "false"
caps "false"
noprefix "false"

\end_inset

 that 
\begin_inset Formula $\det\left(R\right)=\det\left(R^{T}\right)$
\end_inset

 and so
\begin_inset Formula 
\[
\lvert\det\left(T\right)\rvert=1.
\]

\end_inset

We then apply 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:changeOfVariablesLinear"
plural "false"
caps "false"
noprefix "false"

\end_inset

with 
\begin_inset Formula $f=\indicate_{B}$
\end_inset

 and 
\begin_inset Formula $T=R$
\end_inset

.
\end_layout

\begin_layout Subsection
The Lebesgue differentiation theorem and the fundamental theorem of calculus
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:isi2007samplepsb4"

\end_inset

Let 
\begin_inset Formula $f:\mathbb{R}\rightarrow\mathbb{R}$
\end_inset

 be a bounded continuous function.
 Define 
\begin_inset Formula $g:[0,\infty)\rightarrow\R$
\end_inset

 by, 
\begin_inset Formula 
\[
g(x)=\int_{-x}^{x}(2xt+1)f(t)dt.
\]

\end_inset


\end_layout

\begin_layout Example
Show that 
\begin_inset Formula $g$
\end_inset

 is differentiable on 
\begin_inset Formula $(0,\infty)$
\end_inset

 and find the derivative of 
\begin_inset Formula $g$
\end_inset

.
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hl{TODO}
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Non-linear change-of-variables
\end_layout

\begin_layout Subsection
Integration with polar coordinates
\end_layout

\begin_layout Subsection
Symmetry of partial derivatives
\end_layout

\begin_layout Subsection
Convolutions
\begin_inset CommandInset label
LatexCommand label
name "subsec:convolutions"

\end_inset


\end_layout

\begin_layout Standard
When measure spaces have a vector space structure such as 
\begin_inset Formula $\R^{n}$
\end_inset

, we can define some interesting image measures which play an important
 role in probability, fourier analysis, compressed sensing, signal processing
 etc.
\end_layout

\begin_layout Definition
\begin_inset CommandInset label
LatexCommand label
name "def:convolution"

\end_inset

Let 
\begin_inset Formula $\mu,\nu$
\end_inset

 be 
\begin_inset Formula $\sigma-$
\end_inset

finite Borel measures on 
\begin_inset Formula $\R^{n}$
\end_inset

 (i.e.
 measures on 
\begin_inset Formula $\borel\left(\R^{n}\right)$
\end_inset

).
 The 
\emph on
convolution
\emph default
 
\begin_inset Formula $\mu\star\nu$
\end_inset

 is is the image measure of the product 
\begin_inset Formula $\mu\otimes\nu$
\end_inset

 under the map 
\begin_inset Formula $T:\R^{n}\times\R^{n}\to\R$
\end_inset

 given by 
\begin_inset Formula $T\left(x,y\right)=x+y$
\end_inset

.
\end_layout

\begin_layout Definition
Since the product measure always exists and is unique, the convolution always
 exists since 
\begin_inset Formula $T$
\end_inset

 is a continuous (and hence measurable) map.
 Therefore for any bounded, continuous 
\begin_inset Formula $f\in\mathcal{M}\left(\R^{n},\borel\left(\R^{n}\right)\right)$
\end_inset

, we have that
\begin_inset Formula 
\begin{align*}
\lebInt{\mu\star\nu}f & =\lebInt{\mu\otimes\nu}{f\circ T}\\
 & =\mu^{x}\nu^{y}\left(f\left(x+y\right)\right)
\end{align*}

\end_inset

where we have used Corollary 
\begin_inset CommandInset ref
LatexCommand ref
reference "cor:changeOfVariables"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and Fubini's theorem.
 The definition implies that the convolution is symmetric in that 
\begin_inset Formula $\mu\star v=v\star\mu$
\end_inset

.
 It is also possible to define the convolution of a measure with a measurable
 function or of two measurable functions on their own, as is illustrated
 in the following result.
\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "prop:convolutionFunctions"

\end_inset

Let 
\begin_inset Formula $\mu,\nu$
\end_inset

 be 
\begin_inset Formula $\sigma-$
\end_inset

finite measures on 
\begin_inset Formula $\borel\left(\R\right)$
\end_inset

 such that 
\begin_inset Formula $\mu$
\end_inset

 is absolutely continuous with respect to the Lebesgue measure with Radon-Nikody
m derivative 
\begin_inset Formula $g\in\mathcal{M}^{+}\left(\R,\borel\left(\R\right)\right)$
\end_inset

.
 Then, for any bounded, continuous 
\begin_inset Formula $f\in\mathcal{M}\left(\R,\borel\left(\R\right)\right)$
\end_inset


\begin_inset Formula 
\[
\lebInt{\mu\star\nu}f=\lambda^{x}\nu^{y}\left(f\left(x\right)g\left(x-y\right)\right)
\]

\end_inset

 and so 
\begin_inset Formula $\mu\star\nu$
\end_inset

 is absolutely continuous with respect to the Lebesgue measure with Radon-Nikody
m derivative 
\begin_inset Formula 
\[
g\star\nu:=\nu^{y}\left(g\left(x-y\right)\right).
\]

\end_inset


\end_layout

\begin_layout Proof
Note that 
\begin_inset Formula 
\begin{align*}
\lebInt{\mu\star\nu}f & =\mu\otimes\nu\left(f\left(x+y\right)\right)\\
 & =\nu^{y}\mu^{x}\left(f\left(x+y\right)\right)\\
 & =\nu^{y}\lambda^{x}\left(f\left(x+y\right)g\left(x\right)\right)\\
 & =\nu^{y}\lambda^{x}\left(f\left(x\right)g\left(x-y\right)\right)\\
 & =\lambda^{x}\left(f\left(x\right)\nu^{y}\left(g\left(x-y\right)\right)\right)
\end{align*}

\end_inset

where we have used the translation invariance of the Lebesgue measure in
 the fourth equality.
\end_layout

\begin_layout Standard
The Radon-Nikodym derivative 
\begin_inset Formula $g\star\nu$
\end_inset

 is called the convolution of the function 
\begin_inset Formula $g$
\end_inset

 with the measure 
\begin_inset Formula $\nu$
\end_inset

.
 If 
\begin_inset Formula $\nu$
\end_inset

 too was absolutely continuous and had some density 
\begin_inset Formula $h$
\end_inset

 then 
\begin_inset Formula $\mu\star\nu$
\end_inset

 would have density 
\begin_inset Formula $g\star h:=\lambda^{y}\left(g\left(x-y\right)h\left(y\right)\right)$
\end_inset

.
 Note that this definition can be expanded in the usual way to define convolutio
ns of functions that are not necessarily non-negative (as Radon-Nikodym
 derivatives of positive measures are).
 We characterize the symmetry and other properties of convolutions in this
 next result
\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "prop:propertiesConvolution"

\end_inset

Let 
\begin_inset Formula $\mu,\nu$
\end_inset

 be 
\begin_inset Formula $\sigma-$
\end_inset

finite measures on 
\begin_inset Formula $\borel\left(\R^{n}\right)$
\end_inset

 and let 
\begin_inset Formula $f,g,h:\R^{n}\to\R$
\end_inset

 be measurable functions.
 Then
\end_layout

\begin_layout Proposition
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{enumerate}[label=(
\backslash
roman*),leftmargin=.1
\backslash
linewidth,rightmargin=.4
\backslash
linewidth]
\end_layout

\begin_layout Plain Layout


\backslash
item The convolution of two functions is symmetric in that $$ f 
\backslash
star g = g 
\backslash
star f $$.
 
\end_layout

\begin_layout Plain Layout


\backslash
item The convolution of two measures (or of a measure and a function, or
 of two functions) is bilinear in that 
\end_layout

\begin_layout Plain Layout

$$ (
\backslash
alpha f + 
\backslash
beta g) 
\backslash
star h = 
\backslash
alpha f 
\backslash
star h + 
\backslash
beta h 
\backslash
star h $$ with a similar result for the second argument.
\end_layout

\begin_layout Plain Layout


\backslash
end{enumerate}
\end_layout

\end_inset


\end_layout

\begin_layout Proof
For 
\begin_inset Formula $\left(i\right)$
\end_inset

, note that 
\begin_inset Formula $f\star g=\lambda_{n}^{y}\left(f\left(x-y\right)g\left(y\right)\right)=\lambda^{y}\left(f\left(y\right)g\left(x-y\right)\right)=g\star f$
\end_inset

 by using 
\begin_inset Formula $T\left(y\right)=x-y$
\end_inset

 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hl{TODO AFTER CHANGE OF VARIABLES}
\end_layout

\end_inset


\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "prop:derivativeConvolution"

\end_inset


\end_layout

\begin_layout Section
Kernels and disintegration
\end_layout

\begin_layout Standard
So far we have looked at constructing measures on product spaces by taking
 individual measures and combining them in some way to create a measure
 on the product space.
 Often we are interested in the reverse process; that is, we are interested
 in taking a measure on a product space and 
\emph on
disintegrating 
\emph default
it into measures on the individual spaces.
 It turns out that this process is more complicated than the process we
 have seen for constructing product measures.
 As discussed earlier, in the context of probability theory, the process
 of constructing product measures corresponds to the process of constructing
 independent random variables.
 In contrast, the process of disintegrating a measure on a product space
 into component measures corresponds to the process of computing conditional
 distributions.
 If you have some familiarity with probability, you would know that conditioning
 is more complicated than independence l
\end_layout

\begin_layout Standard
The central mathematical objects that underpin the theory of disintegration
 are kernels.
 Kernels are important as they wear two hats: on one hand, they act as measures,
 on the other they act as measurable functions.
\end_layout

\begin_layout Definition
\begin_inset CommandInset label
LatexCommand label
name "def:kernel"

\end_inset

Let 
\begin_inset Formula $\left(\X,\F\right)$
\end_inset

 and 
\begin_inset Formula $\left(\mathcal{Y},\mathcal{G}\right)$
\end_inset

 be measure spaces A kernel 
\begin_inset Formula $\kappa$
\end_inset

 from 
\begin_inset Formula $\left(\X,\F\right)$
\end_inset

 to 
\begin_inset Formula $\left(\mathcal{Y},\mathcal{G}\right)$
\end_inset

 is a function 
\begin_inset Formula $\kappa:\mathcal{G}\times\X\to\left[0,\infty\right]$
\end_inset

 such that for any fixed 
\begin_inset Formula $G_{0}\in\mathcal{G}$
\end_inset

 , the map
\begin_inset Formula 
\[
x\to\kappa\left(G_{0},x\right)
\]

\end_inset

is 
\begin_inset Formula $\F/\borel\left(\R\right)$
\end_inset

 measurable and for every fixed 
\begin_inset Formula $x_{0}\in\X$
\end_inset

 , the map 
\begin_inset Formula 
\[
G\to\kappa\left(G,x_{0}\right)
\]

\end_inset

is a measure on 
\begin_inset Formula $\mathcal{G}.$
\end_inset


\end_layout

\begin_layout Remark*
It is sometimes more intuitive to think of a kernel from 
\begin_inset Formula $\left(\X,\F\right)$
\end_inset

 to 
\begin_inset Formula $\left(\mathcal{Y},\mathcal{G}\right)$
\end_inset

 as a collection of measures on 
\begin_inset Formula $\mathcal{G}$
\end_inset

 indexed by 
\begin_inset Formula $\X$
\end_inset

.
 So we can write
\begin_inset Formula 
\[
K:=\left\{ \kappa_{x}:x\in\X\right\} 
\]

\end_inset

where each 
\begin_inset Formula $\kappa_{x}$
\end_inset

 is a measure on 
\begin_inset Formula $\mathcal{G}$
\end_inset

 and 
\begin_inset Formula $x\to\kappa_{x}\left(G\right)$
\end_inset

 is measurable for each 
\begin_inset Formula $G\in\mathcal{G}$
\end_inset

.
 When these measures are restricted to the range 
\begin_inset Formula $\left[0,1\right]$
\end_inset

 the kernel is called a 
\emph on
Markov kernel.
\end_layout

\begin_layout Standard
A generalization of the Tonelli theorem allows us to work with kernels.
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:tonelliKernels"

\end_inset

Let 
\begin_inset Formula $K=\left\{ \kappa_{x}:x\in\X\right\} $
\end_inset

 be a kernel from 
\begin_inset Formula $\left(\X,\F\right)$
\end_inset

 and 
\begin_inset Formula $\left(\mathcal{Y},\mathcal{G}\right)$
\end_inset

 such that 
\begin_inset Formula $\kappa_{x}$
\end_inset

 is 
\begin_inset Formula $\sigma-$
\end_inset

finite for every 
\begin_inset Formula $x\in\X$
\end_inset

.
 Let 
\begin_inset Formula $\mu$
\end_inset

be a 
\begin_inset Formula $\sigma-$
\end_inset

finite measure on 
\begin_inset Formula $\F$
\end_inset

.
 Then, for 
\begin_inset Formula $f\in\mathcal{M}^{+}\left(\X\times\mathcal{Y},\mathcal{F}\otimes\mathcal{G}\right)$
\end_inset


\end_layout

\begin_layout Theorem
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{enumerate}[label=(
\backslash
roman*),leftmargin=.1
\backslash
linewidth,rightmargin=.4
\backslash
linewidth]
\end_layout

\begin_layout Plain Layout


\backslash
item $y 
\backslash
to f
\backslash
left(x,y
\backslash
right)$ is $
\backslash
mathcal{G}/
\backslash
borel
\backslash
left(
\backslash
R
\backslash
right)$ measurable
\end_layout

\begin_layout Plain Layout


\backslash
item $x 
\backslash
to 
\backslash
kappa_x
\backslash
left(f
\backslash
left(x,y
\backslash
right)
\backslash
right)$ is $
\backslash
mathcal{F}/
\backslash
borel
\backslash
left(
\backslash
R
\backslash
right)$ measurable
\end_layout

\begin_layout Plain Layout


\backslash
item $
\backslash
left(
\backslash
mu 
\backslash
otimes K
\backslash
right) := 
\backslash
mu^x
\backslash
left(
\backslash
kappa_x^y
\backslash
left(f
\backslash
left(x,y
\backslash
right)
\backslash
right)
\backslash
right)$ is an integral on $
\backslash
F
\backslash
otimes
\backslash
mathcal{G}$.
\end_layout

\begin_layout Plain Layout


\backslash
end{enumerate}
\end_layout

\end_inset


\end_layout

\begin_layout Proof
Note that 
\begin_inset Formula $(i)$
\end_inset

 is simply Lemma 
\begin_inset CommandInset ref
LatexCommand ref
reference "lem:partialFunctionMeasurability"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 For 
\begin_inset Formula $\left(ii\right)$
\end_inset

, we can treat
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hl{Tatikonda}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hl{Chang and Pollard, 1997}
\end_layout

\end_inset


\end_layout

\begin_layout Section
Extension to infinite product spaces
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
hl{ASH or KLENKE?}
\end_layout

\end_inset


\end_layout

\end_body
\end_document
